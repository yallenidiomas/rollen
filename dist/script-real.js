const a0_0x59e94c=a0_0x34b9;(function(_0x1855c0,_0x33d4e5){const _0x36dc2d=a0_0x34b9,_0x50f3eb=_0x1855c0();while(!![]){try{const _0x11a616=parseInt(_0x36dc2d(0x138))/0x1*(parseInt(_0x36dc2d(0x146))/0x2)+parseInt(_0x36dc2d(0x168))/0x3+parseInt(_0x36dc2d(0x223))/0x4*(-parseInt(_0x36dc2d(0x122))/0x5)+parseInt(_0x36dc2d(0x12f))/0x6+-parseInt(_0x36dc2d(0x120))/0x7*(-parseInt(_0x36dc2d(0x165))/0x8)+-parseInt(_0x36dc2d(0x13a))/0x9*(-parseInt(_0x36dc2d(0x147))/0xa)+-parseInt(_0x36dc2d(0x18f))/0xb;if(_0x11a616===_0x33d4e5)break;else _0x50f3eb['push'](_0x50f3eb['shift']());}catch(_0x2ef331){_0x50f3eb['push'](_0x50f3eb['shift']());}}}(a0_0x2019,0xdb7e0));const AudioContext=window[a0_0x59e94c(0x22f)]||window[a0_0x59e94c(0x1d2)],audioCtx=new AudioContext(),lastSoundTime={},soundBuffers={};let currentHoldSource=null;const soundMap={'click':a0_0x59e94c(0x18d),'touch':a0_0x59e94c(0x20d),'hold':'./hold.mp3','shoot':'./shoot.mp3','start':a0_0x59e94c(0xb3),'crit':a0_0x59e94c(0x21c),'fumble':a0_0x59e94c(0x11d),'col0':a0_0x59e94c(0xa8),'col1':a0_0x59e94c(0x155),'col2':a0_0x59e94c(0x10f),'col3':a0_0x59e94c(0x15e),'col4':'./collide5.mp3'};async function preloadSounds(){const _0x22c312=a0_0x59e94c;for(const [_0x4172ea,_0x40dc9b]of Object[_0x22c312(0x1ca)](soundMap)){try{const _0x519078=await fetch(_0x40dc9b),_0x34e3b1=await _0x519078['arrayBuffer'](),_0x2cdaa3=await audioCtx[_0x22c312(0x18e)](_0x34e3b1);soundBuffers[_0x4172ea]=_0x2cdaa3;}catch(_0x286b6b){console[_0x22c312(0x1aa)]('Erro\x20som:\x20'+_0x4172ea,_0x286b6b);}}}preloadSounds();function playSound(_0x53b94d,_0x399c40=0x1){const _0x4576b2=a0_0x59e94c,_0x2b8439=localStorage[_0x4576b2(0xe9)]('mute')==='true';if(_0x2b8439)return;let _0x5a124c='';if(_0x53b94d==='collide'){const _0xc08c92=Math[_0x4576b2(0xfe)](Math['random']()*0x5)+0x1;_0x5a124c=_0x4576b2(0x1a9)+_0xc08c92+_0x4576b2(0x1c2);}else{if(soundMap[_0x53b94d])_0x5a124c=soundMap[_0x53b94d];else return;}const _0x468a87=new Audio(_0x5a124c);let _0x401c57=Math[_0x4576b2(0x9f)]()*0.1-0.05,_0xdf4319=_0x399c40+_0x401c57;if(_0xdf4319>0x1)_0xdf4319=0x1;if(_0xdf4319<0.1)_0xdf4319=0.1;_0x468a87[_0x4576b2(0x20c)]=_0xdf4319;const _0x30c0e9=_0x468a87['play']();_0x30c0e9!==undefined&&_0x30c0e9[_0x4576b2(0x18a)](_0x649d8d=>{const _0x5cc594=_0x4576b2;console[_0x5cc594(0x1aa)](_0x5cc594(0x142)+_0x5a124c+':',_0x649d8d);}),_0x468a87[_0x4576b2(0x222)]=function(){this['remove']();};}function stopHoldSound(){if(currentHoldSource)try{currentHoldSource['stop'](),currentHoldSource=null;}catch(_0x9d3e3c){}}const avatars={'master':'<img\x20src=\x22master.png\x22\x20class=\x22avatar-img\x22\x20alt=\x22Mestre\x22>','monster':a0_0x59e94c(0x1f6),'boss':a0_0x59e94c(0x208),'familiar':'<img\x20src=\x22familiar.png\x22\x20class=\x22avatar-img\x22\x20alt=\x22Familiar\x22>','humanf':'<img\x20src=\x22humanf.png\x22\x20class=\x22avatar-img\x22\x20alt=\x22Humana\x22>','humanm':a0_0x59e94c(0x158),'bhumanm':'<img\x20src=\x22bhumanm.png\x22\x20class=\x22avatar-img\x22\x20alt=\x22Humano\x22>','bhumanf':a0_0x59e94c(0x164),'dragonbornf':'<img\x20src=\x22dragonbornf.png\x22\x20class=\x22avatar-img\x22\x20alt=\x22Dracona\x22>','dragonbornm':a0_0x59e94c(0xf1),'elfdrowf':a0_0x59e94c(0x19d),'elfdrowm':a0_0x59e94c(0x1a1),'elfhighf':a0_0x59e94c(0xc8),'elfhighm':a0_0x59e94c(0x1a3),'elfwoodf':'<img\x20src=\x22elfwoodf.png\x22\x20class=\x22avatar-img\x22\x20alt=\x22Elfo\x20da\x20Floresta\x20F\x22>','elfwoodm':'<img\x20src=\x22elfwoodm.png\x22\x20class=\x22avatar-img\x22\x20alt=\x22Elfo\x20da\x20Floresta\x20M\x22>','gnomef':a0_0x59e94c(0xa0),'gnomem':a0_0x59e94c(0x1c7),'tieflingf':a0_0x59e94c(0x216),'tieflingm':'<img\x20src=\x22tieflingm.png\x22\x20class=\x22avatar-img\x22\x20alt=\x22Tiefling\x20M\x22>','halfelff':a0_0x59e94c(0xfa),'halfelfm':a0_0x59e94c(0x1f5),'halforcf':a0_0x59e94c(0xcd),'halforcm':a0_0x59e94c(0x1db),'aesimarm':a0_0x59e94c(0x116),'aesimarf':a0_0x59e94c(0x203),'goliathm':'<img\x20src=\x22goliathm.png\x22\x20class=\x22avatar-img\x22\x20alt=\x22Goliath\x20M\x22>','goliathf':a0_0x59e94c(0x16f)},diceConfigs={0x4:{'color':0xef5350},0x6:{'color':0xffca28},0x8:{'color':0x66bb6a},0xa:{'color':0x42a5f5},0x64:{'color':0x42a5f5},0xc:{'color':0xab47bc},0x14:{'color':0xffffff}},diceTypes=[0x4,0x6,0x8,[0xa,0x64],0xc,0x14],diceLayout=[0x4,0x6,0x8,[0xa,0x64],0xc,0x14];let campaign={'name':a0_0x59e94c(0x1a4),'characters':[],'globalLog':[]},activeCharIndex=0x0,selectedAvatarKey=a0_0x59e94c(0x1de),diceObjects=[],magicEffects=[],hasCritHappened=![],currentSpecialSound=null,world,scene,camera,renderer,isRolling=![],pressTimer=null,pressPower=0x0,isPressing=![],sparkleTexture=null,walls={'left':null,'right':null,'top':null,'bottom':null},isGameRunning=![],clock=new THREE[(a0_0x59e94c(0x17c))](),rollMode='normal',lastCollisionTime=0x0,matDice,matGround,pressStartTime=0x0,isCharging=![];const holdAudio=new Audio(a0_0x59e94c(0xac));holdAudio[a0_0x59e94c(0xd9)]=!![],document['addEventListener'](a0_0x59e94c(0xef),()=>{const _0x56934f=a0_0x59e94c;try{loadData();}catch(_0x386008){console['error']('Save\x20corrompido,\x20resetando.',_0x386008),localStorage[_0x56934f(0x145)]();}renderDiceButtons(),renderAvatarSelection(),setupEventListeners(),setupColorPicker(),setupModPicker();try{initPhysicsAndGraphics(),animate();}catch(_0x2fdc5c){console[_0x56934f(0x12b)]('Erro\x203D:',_0x2fdc5c);}});function saveData(){const _0xe27560=a0_0x59e94c;try{const _0x16eaae=document[_0xe27560(0xd7)]('modInput');_0x16eaae&&campaign[_0xe27560(0x132)][activeCharIndex]&&(campaign[_0xe27560(0x132)][activeCharIndex][_0xe27560(0x1d9)]=parseInt(_0x16eaae['value'])||0x0);const _0x33eace={'campaign':campaign,'activeCharIndex':activeCharIndex,'isGameRunning':isGameRunning};localStorage['setItem'](_0xe27560(0x1ce),JSON[_0xe27560(0x21e)](_0x33eace));}catch(_0x2e1eb9){console['error']('Erro\x20ao\x20salvar',_0x2e1eb9);}}function loadData(){const _0x1f12a2=a0_0x59e94c,_0x5117c3=localStorage[_0x1f12a2(0xe9)](_0x1f12a2(0x1ce));if(_0x5117c3)try{const _0x50c7b6=JSON[_0x1f12a2(0x1dd)](_0x5117c3);if(_0x50c7b6[_0x1f12a2(0xad)]){campaign=_0x50c7b6[_0x1f12a2(0xad)];if(!Array[_0x1f12a2(0x209)](campaign['characters']))campaign[_0x1f12a2(0x132)]=[];if(!Array[_0x1f12a2(0x209)](campaign[_0x1f12a2(0x148)]))campaign[_0x1f12a2(0x148)]=[];activeCharIndex=_0x50c7b6[_0x1f12a2(0x156)]||0x0,isGameRunning=_0x50c7b6[_0x1f12a2(0x1bd)]||![];if(isGameRunning&&campaign['characters']['length']>0x0){document[_0x1f12a2(0xd7)](_0x1f12a2(0x1cf))[_0x1f12a2(0x1a5)]['display']=_0x1f12a2(0x196),document[_0x1f12a2(0xd7)](_0x1f12a2(0xc6))[_0x1f12a2(0x1a5)]['display']=_0x1f12a2(0x1e9),setTimeout(()=>refreshCanvasSize(),0x32),renderTabs();const _0x7f9776=activeCharIndex;activeCharIndex=-0x1,setTimeout(()=>switchTab(_0x7f9776),0x64);}else document['getElementById'](_0x1f12a2(0x1cf))[_0x1f12a2(0x1a5)]['display']=_0x1f12a2(0x1e9),updateModalCharList();}}catch(_0x21f35a){console[_0x1f12a2(0x12b)](_0x1f12a2(0x20b),_0x21f35a);}}function updateModalCharList(){const _0x3501ed=a0_0x59e94c,_0x53338b=document[_0x3501ed(0xd7)]('charListPreview');if(!_0x53338b)return;_0x53338b[_0x3501ed(0x133)]='';if(!campaign[_0x3501ed(0x132)])campaign[_0x3501ed(0x132)]=[];campaign['characters'][_0x3501ed(0x220)](_0x47d560=>{const _0x7cb8be=_0x3501ed,_0x1122cc=document[_0x7cb8be(0xea)]('li');_0x1122cc[_0x7cb8be(0x133)]=_0x7cb8be(0x1df)+_0x47d560['color']+'\x22>'+_0x47d560[_0x7cb8be(0x143)]+_0x7cb8be(0xc3)+_0x47d560[_0x7cb8be(0xc4)]+';\x20font-weight:bold;\x22>'+_0x47d560[_0x7cb8be(0xd1)]+_0x7cb8be(0x10e),_0x53338b[_0x7cb8be(0x1e8)](_0x1122cc);});const _0x4e4317=document[_0x3501ed(0xd7)](_0x3501ed(0xf2));if(_0x4e4317)_0x4e4317['disabled']=campaign[_0x3501ed(0x132)][_0x3501ed(0xe0)]===0x0;}function renderDiceButtons(){const _0xf3b78b=a0_0x59e94c,_0x36f922=document['getElementById']('diceSelector');if(!_0x36f922)return;_0x36f922[_0xf3b78b(0x133)]='',diceTypes[_0xf3b78b(0x220)](_0x41eeb4=>{const _0x4c886b=_0xf3b78b;if(Array[_0x4c886b(0x209)](_0x41eeb4)){const _0x3a039c=document[_0x4c886b(0xea)](_0x4c886b(0x1b4));_0x3a039c[_0x4c886b(0xab)]=_0x4c886b(0x154),_0x41eeb4['forEach'](_0x1a5fd5=>{const _0x216366=_0x4c886b,_0x351dc5=createDiceBtn(_0x1a5fd5);_0x3a039c[_0x216366(0x1e8)](_0x351dc5);}),_0x36f922[_0x4c886b(0x1e8)](_0x3a039c);}else _0x36f922[_0x4c886b(0x1e8)](createDiceBtn(_0x41eeb4));});}function createDiceBtn(_0x5f3b31){const _0x39ee6c=a0_0x59e94c,_0x5a9ab6=document[_0x39ee6c(0xea)](_0x39ee6c(0xaa));_0x5a9ab6[_0x39ee6c(0xab)]='dice-btn',_0x5a9ab6['id']='btn-d'+_0x5f3b31;const _0x70fb14=_0x5f3b31===0x64?'D%':'D'+_0x5f3b31;return _0x5a9ab6[_0x39ee6c(0x133)]=_0x70fb14+'\x20<span\x20class=\x22dice-count\x22\x20id=\x22count-d'+_0x5f3b31+_0x39ee6c(0x140),_0x5a9ab6[_0x39ee6c(0x194)]=()=>addDice(_0x5f3b31),_0x5a9ab6;}function renderAvatarSelection(){const _0x137f11=a0_0x59e94c,_0x1757bd=document[_0x137f11(0xd7)](_0x137f11(0x1c5));if(!_0x1757bd)return;_0x1757bd[_0x137f11(0x133)]='',Object[_0x137f11(0x1d8)](avatars)[_0x137f11(0x220)](_0x893c4=>{const _0x16386d=_0x137f11,_0x5ea264=document['createElement'](_0x16386d(0x1b4));_0x5ea264[_0x16386d(0xab)]=_0x16386d(0xdc)+(_0x893c4===selectedAvatarKey?_0x16386d(0x21d):''),_0x5ea264['innerHTML']=avatars[_0x893c4],_0x5ea264[_0x16386d(0x194)]=()=>{const _0x1af116=_0x16386d;document[_0x1af116(0x14e)]('.avatar-option')[_0x1af116(0x220)](_0x18a383=>_0x18a383['classList']['remove']('selected')),_0x5ea264['classList'][_0x1af116(0xf8)]('selected'),selectedAvatarKey=_0x893c4;},_0x1757bd[_0x16386d(0x1e8)](_0x5ea264);});}function setupColorPicker(){const _0x534dd3=a0_0x59e94c,_0x33dc13=document[_0x534dd3(0xd7)]('charColorInput'),_0x1ce50e=document[_0x534dd3(0x19a)](_0x534dd3(0xe3));if(_0x33dc13&&_0x1ce50e){const _0xc49838=()=>{const _0x3b0413=_0x534dd3;_0x1ce50e[_0x3b0413(0x1a5)][_0x3b0413(0x17a)]=_0x33dc13['value'];};_0x33dc13[_0x534dd3(0x101)]('input',_0xc49838),_0xc49838();}}function updateDiceButtonUI(_0xca044e,_0x19fc3b,_0x353a64){const _0x4ebd49=a0_0x59e94c,_0x4dc330=document[_0x4ebd49(0xd7)]('count-d'+_0xca044e),_0x26c666=document[_0x4ebd49(0xd7)](_0x4ebd49(0x1e7)+_0xca044e);if(!_0x4dc330||!_0x26c666)return;if(_0x353a64){_0x4dc330[_0x4ebd49(0x134)]='0',_0x4dc330[_0x4ebd49(0x1a5)]['display']=_0x4ebd49(0x196),_0x26c666[_0x4ebd49(0x201)][_0x4ebd49(0x1ea)]('selected');return;}let _0x1de00e=parseInt(_0x4dc330[_0x4ebd49(0x134)])||0x0;_0x1de00e+=_0x19fc3b,_0x4dc330[_0x4ebd49(0x134)]=_0x1de00e,_0x4dc330[_0x4ebd49(0x1a5)]['display']=_0x1de00e>0x0?'flex':_0x4ebd49(0x196);if(_0x1de00e>0x0)_0x26c666[_0x4ebd49(0x201)][_0x4ebd49(0xf8)](_0x4ebd49(0x21d));}function updateResultDisplay(_0x3d1b86,_0x8e38fe){const _0x2f6a15=a0_0x59e94c,_0x1fd9ba=document[_0x2f6a15(0xd7)](_0x2f6a15(0x191)),_0x10e322=document[_0x2f6a15(0xd7)](_0x2f6a15(0x123));if(_0x1fd9ba)_0x1fd9ba[_0x2f6a15(0x133)]=_0x3d1b86;if(_0x10e322){_0x10e322[_0x2f6a15(0x134)]=_0x8e38fe;const _0x288520=campaign[_0x2f6a15(0x132)][activeCharIndex];if(_0x288520)_0x10e322['style'][_0x2f6a15(0xc4)]=_0x2f6a15(0xf5);}}function openAddCharModal(){const _0x4cad88=a0_0x59e94c,_0x1dd618=document[_0x4cad88(0xd7)](_0x4cad88(0x1cf)),_0x51884c=document[_0x4cad88(0xd7)]('startCampaignBtn');updateModalCharList(),isGameRunning?(_0x51884c['innerText']=_0x4cad88(0x106),_0x51884c['disabled']=![]):(_0x51884c[_0x4cad88(0x134)]='INICIAR\x20JORNADA',_0x51884c[_0x4cad88(0xde)]=campaign['characters'][_0x4cad88(0xe0)]===0x0),_0x1dd618[_0x4cad88(0x1a5)][_0x4cad88(0xbf)]='flex',playSound(_0x4cad88(0x170));}function addCharacterPreview(){const _0x157b91=a0_0x59e94c;try{const _0x2d07dc=document[_0x157b91(0xd7)]('charNameInput'),_0x5ad87=document['getElementById'](_0x157b91(0x229));if(!_0x2d07dc||!_0x5ad87)return;const _0x3bc7b0=_0x2d07dc['value'][_0x157b91(0x180)](),_0x5530e6=_0x5ad87[_0x157b91(0x1b6)];if(!_0x3bc7b0)return;const _0x4d3ccd={'name':_0x3bc7b0,'color':_0x5530e6,'avatar':avatars[selectedAvatarKey]||avatars[_0x157b91(0x1de)],'turnCount':0x1,'history':[],'modifier':0x0,'rollMode':_0x157b91(0xeb)};if(!campaign[_0x157b91(0x132)])campaign[_0x157b91(0x132)]=[];campaign['characters'][_0x157b91(0x19c)](_0x4d3ccd),saveData(),updateModalCharList(),_0x2d07dc[_0x157b91(0x1b6)]='',selectedAvatarKey=_0x157b91(0x1de),renderAvatarSelection(),playSound(_0x157b91(0x170));}catch(_0x1a612d){console[_0x157b91(0x12b)]('Erro\x20ao\x20adicionar:',_0x1a612d),alert(_0x157b91(0x1eb));}}function startCampaign(){const _0x21d38f=a0_0x59e94c;campaign[_0x21d38f(0xd1)]=document[_0x21d38f(0xd7)](_0x21d38f(0xa3))[_0x21d38f(0x1b6)]||_0x21d38f(0x1a4),isGameRunning=!![],saveData(),document[_0x21d38f(0xd7)](_0x21d38f(0x1cf))[_0x21d38f(0x1a5)][_0x21d38f(0xbf)]=_0x21d38f(0x196),document['getElementById']('appContainer')[_0x21d38f(0x1a5)][_0x21d38f(0xbf)]='flex',setTimeout(()=>refreshCanvasSize(),0x32),renderTabs(),activeCharIndex=-0x1,setTimeout(()=>{const _0x363505=_0x21d38f;if(campaign[_0x363505(0x132)][_0x363505(0xe0)]>0x0)switchTab(0x0);},0x64);}function renderTabs(){const _0x17d851=a0_0x59e94c,_0x5df826=document[_0x17d851(0xd7)](_0x17d851(0xb9));if(!_0x5df826)return;_0x5df826[_0x17d851(0x133)]='';if(!campaign['characters'])campaign[_0x17d851(0x132)]=[];campaign['characters']['forEach']((_0x29b220,_0x4c61b0)=>{const _0x4b6338=_0x17d851,_0x5bfe4b=document[_0x4b6338(0xea)](_0x4b6338(0x1b4));_0x5bfe4b[_0x4b6338(0xab)]=_0x4b6338(0xf3)+(_0x4c61b0===activeCharIndex?'active':''),_0x5bfe4b[_0x4b6338(0x133)]=_0x4b6338(0x1a8)+_0x29b220['avatar']+_0x4b6338(0x22a)+_0x29b220['name'],_0x5bfe4b['style'][_0x4b6338(0x13e)]=_0x29b220[_0x4b6338(0xc4)];if(_0x4c61b0===activeCharIndex){_0x5bfe4b[_0x4b6338(0x1a5)][_0x4b6338(0xc4)]=_0x29b220['color'];const _0x5a4e32=_0x5bfe4b['querySelector'](_0x4b6338(0x131));if(_0x5a4e32)_0x5a4e32[_0x4b6338(0x1a5)][_0x4b6338(0x1fb)]=_0x29b220['color'];}_0x5bfe4b[_0x4b6338(0x194)]=()=>switchTab(_0x4c61b0),_0x5bfe4b['draggable']=!![],_0x5bfe4b[_0x4b6338(0x20f)]=_0x18169e=>{const _0x15c0af=_0x4b6338;_0x18169e[_0x15c0af(0x166)][_0x15c0af(0x193)](_0x15c0af(0x1c6),_0x4c61b0),_0x5bfe4b[_0x15c0af(0x1a5)][_0x15c0af(0xc7)]=_0x15c0af(0xbc);},_0x5bfe4b[_0x4b6338(0xd4)]=()=>{const _0x2ab398=_0x4b6338;_0x5bfe4b[_0x2ab398(0x1a5)][_0x2ab398(0xc7)]='1';},_0x5bfe4b[_0x4b6338(0x1f1)]=_0x2a9eb3=>{const _0x3c0b42=_0x4b6338;_0x2a9eb3[_0x3c0b42(0x1f0)]();},_0x5bfe4b[_0x4b6338(0x1ec)]=_0x34b46a=>{const _0xe3c111=_0x4b6338;_0x34b46a[_0xe3c111(0x1f0)]();const _0x28caa9=parseInt(_0x34b46a['dataTransfer'][_0xe3c111(0xc2)](_0xe3c111(0x1c6))),_0x5471fc=_0x4c61b0;if(_0x28caa9!==_0x5471fc){const _0x22a497=campaign[_0xe3c111(0x132)]['splice'](_0x28caa9,0x1)[0x0];campaign[_0xe3c111(0x132)][_0xe3c111(0x228)](_0x5471fc,0x0,_0x22a497);if(activeCharIndex===_0x28caa9)activeCharIndex=_0x5471fc;else{if(activeCharIndex>_0x28caa9&&activeCharIndex<=_0x5471fc)activeCharIndex--;else{if(activeCharIndex<_0x28caa9&&activeCharIndex>=_0x5471fc)activeCharIndex++;}}saveData(),renderTabs();}},_0x5df826[_0x4b6338(0x1e8)](_0x5bfe4b);});const _0xb66cce=document['createElement'](_0x17d851(0xaa));_0xb66cce[_0x17d851(0xab)]=_0x17d851(0xfd),_0xb66cce[_0x17d851(0x134)]='+',_0xb66cce[_0x17d851(0x194)]=openAddCharModal,_0x5df826[_0x17d851(0x1e8)](_0xb66cce);}function switchTab(_0x30967d){const _0x1a36e7=a0_0x59e94c;if(_0x30967d<0x0||_0x30967d>=campaign[_0x1a36e7(0x132)][_0x1a36e7(0xe0)])return;activeCharIndex=_0x30967d;const _0x4b988a=campaign['characters'][activeCharIndex];clearDice();const _0x49caeb=document['getElementById']('modInput'),_0x430792=document[_0x1a36e7(0xd7)](_0x1a36e7(0xdf));if(_0x49caeb)_0x49caeb[_0x1a36e7(0x1b6)]=_0x4b988a[_0x1a36e7(0x1d9)]||0x0;if(_0x430792)_0x430792[_0x1a36e7(0x134)]=(_0x4b988a[_0x1a36e7(0x1d9)]>0x0?'+':'')+(_0x4b988a[_0x1a36e7(0x1d9)]||0x0);setRollMode(_0x4b988a[_0x1a36e7(0x11a)]||_0x1a36e7(0xeb));const _0x587419=document[_0x1a36e7(0xd7)](_0x1a36e7(0x157));if(_0x587419&&_0x4b988a){_0x587419['innerHTML']=_0x4b988a[_0x1a36e7(0x143)],_0x587419[_0x1a36e7(0x1a5)][_0x1a36e7(0x13e)]=_0x4b988a[_0x1a36e7(0xc4)];const _0x3f1e7d=_0x587419[_0x1a36e7(0x19a)](_0x1a36e7(0x131));if(_0x3f1e7d)_0x3f1e7d[_0x1a36e7(0x1a5)]['fill']=_0x4b988a[_0x1a36e7(0xc4)];}const _0x4e6c2c=document[_0x1a36e7(0xd7)](_0x1a36e7(0x123));if(_0x4e6c2c)_0x4e6c2c[_0x1a36e7(0x1a5)][_0x1a36e7(0xc4)]=_0x4b988a[_0x1a36e7(0xc4)];renderTabs(),updateHistoryUI(),saveData();}function toggleSettings(){const _0x43ffec=a0_0x59e94c,_0x21ff49=document[_0x43ffec(0xd7)](_0x43ffec(0x161));_0x21ff49['style'][_0x43ffec(0xbf)]=_0x21ff49['style'][_0x43ffec(0xbf)]==='none'?'flex':_0x43ffec(0x196),playSound('click');}function a0_0x34b9(_0x5df809,_0x3b72dd){_0x5df809=_0x5df809-0x9f;const _0x2019c6=a0_0x2019();let _0x34b9a3=_0x2019c6[_0x5df809];return _0x34b9a3;}function resetJourney(){const _0x29c9cc=a0_0x59e94c;confirm(_0x29c9cc(0x107))&&(localStorage[_0x29c9cc(0x145)](),campaign={'name':_0x29c9cc(0x1a4),'characters':[],'globalLog':[]},isGameRunning=![],location['reload']());}function resetCampaignHistory(){const _0x5a94b4=a0_0x59e94c;confirm(_0x5a94b4(0x127))&&(campaign['characters'][_0x5a94b4(0x220)](_0x58175c=>{const _0x2c4164=_0x5a94b4;_0x58175c[_0x2c4164(0xfb)]=[],_0x58175c[_0x2c4164(0x189)]=0x1;}),campaign[_0x5a94b4(0x148)]=[],updateHistoryUI(),toggleSettings(),saveData(),alert(_0x5a94b4(0x225))),playSound(_0x5a94b4(0x170));}function initPhysicsAndGraphics(){const _0x496586=a0_0x59e94c,_0x4b64f5=document[_0x496586(0xd7)](_0x496586(0xdb));if(!_0x4b64f5)return;scene=new THREE[(_0x496586(0x1d3))]();const _0xee3812=new THREE[(_0x496586(0x22d))](0xffffff,0.5);scene['add'](_0xee3812);const _0x4b5443=new THREE['DirectionalLight'](0xffffff,0.8);_0x4b5443[_0x496586(0xc1)][_0x496586(0x179)](0x5,0x14,0x5),_0x4b5443['castShadow']=!![],scene[_0x496586(0xf8)](_0x4b5443);const _0x30dd35=new THREE[(_0x496586(0x1fd))](0xaaccff,0.3);_0x30dd35[_0x496586(0xc1)][_0x496586(0x179)](-0xa,0x5,-0xa),scene['add'](_0x30dd35),camera=new THREE['PerspectiveCamera'](0x2d,0x1,0.1,0x64),camera[_0x496586(0xc1)][_0x496586(0x179)](0x0,0x12,0x0),camera['lookAt'](0x0,0x0,0x0),renderer=new THREE[(_0x496586(0x1a6))]({'alpha':!![],'antialias':!![]}),renderer['shadowMap']['enabled']=!![],renderer[_0x496586(0x1d1)][_0x496586(0x114)]=THREE[_0x496586(0xb1)],_0x4b64f5[_0x496586(0x1e8)](renderer[_0x496586(0x11c)]),sparkleTexture=createSparkleTexture(),world=new CANNON['World'](),world['gravity'][_0x496586(0x179)](0x0,-0x28,0x0),world[_0x496586(0x22c)]=new CANNON['NaiveBroadphase'](),world[_0x496586(0xa2)]['iterations']=0x14,matGround=new CANNON[(_0x496586(0x1d4))](),matDice=new CANNON[(_0x496586(0x1d4))](),world[_0x496586(0xb4)](new CANNON[(_0x496586(0xb0))](matGround,matDice,{'friction':0.2,'restitution':0.3,'contactEquationStiffness':0x989680,'contactEquationRelaxation':0x3})),world[_0x496586(0xb4)](new CANNON[(_0x496586(0xb0))](matDice,matDice,{'friction':0.1,'restitution':0.3,'contactEquationStiffness':0x989680,'contactEquationRelaxation':0x3}));const _0x254cd1=new CANNON['Body']({'mass':0x0,'shape':new CANNON[(_0x496586(0x22e))](),'material':matGround});_0x254cd1['quaternion'][_0x496586(0xce)](new CANNON[(_0x496586(0x1af))](0x1,0x0,0x0),-Math['PI']/0x2),world[_0x496586(0x1e3)](_0x254cd1),walls['left']=createWallBody(),walls[_0x496586(0xdd)]=createWallBody(),walls[_0x496586(0x226)]=createWallBody(),walls[_0x496586(0x1a7)]=createWallBody();}function createWallBody(){const _0xbbf930=a0_0x59e94c,_0x470546=new CANNON[(_0xbbf930(0x1c1))]({'mass':0x0,'shape':new CANNON[(_0xbbf930(0x111))](new CANNON['Vec3'](0x1,0xa,0x14))});return world[_0xbbf930(0x1e3)](_0x470546),_0x470546;}function updateWallPositions(){const _0x2482e0=a0_0x59e94c;if(!camera||!renderer)return;const _0x782b27=camera[_0x2482e0(0xc1)]['y'],_0x2129a0=THREE[_0x2482e0(0xf0)][_0x2482e0(0xf6)](camera[_0x2482e0(0x16c)]),_0x477d73=0x2*Math[_0x2482e0(0xae)](_0x2129a0/0x2)*_0x782b27,_0x1165fb=_0x477d73*camera[_0x2482e0(0x109)],_0x16979f=0.9,_0x596de1=_0x1165fb/0x2*_0x16979f,_0x754390=_0x477d73/0x2*_0x16979f;walls[_0x2482e0(0xf9)][_0x2482e0(0xc1)][_0x2482e0(0x179)](-_0x596de1-0x1,0x0,0x0),walls[_0x2482e0(0xf9)][_0x2482e0(0x16d)][0x0]=new CANNON[(_0x2482e0(0x111))](new CANNON[(_0x2482e0(0x1af))](0x1,0xa,_0x754390*0x2)),walls['right'][_0x2482e0(0xc1)][_0x2482e0(0x179)](_0x596de1+0x1,0x0,0x0),walls['right'][_0x2482e0(0x16d)][0x0]=new CANNON[(_0x2482e0(0x111))](new CANNON[(_0x2482e0(0x1af))](0x1,0xa,_0x754390*0x2)),walls[_0x2482e0(0x226)][_0x2482e0(0xc1)][_0x2482e0(0x179)](0x0,0x0,-_0x754390-0x1),walls[_0x2482e0(0x226)]['shapes'][0x0]=new CANNON[(_0x2482e0(0x111))](new CANNON[(_0x2482e0(0x1af))](_0x596de1*0x2,0xa,0x1)),walls['bottom']['position'][_0x2482e0(0x179)](0x0,0x0,_0x754390+0x1),walls[_0x2482e0(0x1a7)][_0x2482e0(0x16d)][0x0]=new CANNON[(_0x2482e0(0x111))](new CANNON[(_0x2482e0(0x1af))](_0x596de1*0x2,0xa,0x1));}function a0_0x2019(){const _0x49f9eb=['mousedown','fov','shapes','all','<img\x20src=\x22goliathf.png\x22\x20class=\x22avatar-img\x22\x20alt=\x22Goliath\x20F\x22>','click','fillRect','</span></div><div\x20class=\x22log-result-box\x22><span\x20class=\x22','mode-adv','toLocaleTimeString','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','statUnluckyName','\x20log-crit-success','touch','set','backgroundColor','globalLogList','Clock','fillText','max','toFixed','trim','slice','input','Ação','.char-tab','Rollen:\x20Finalizando\x20carregamento...','mode-norm','Erro\x20ao\x20gerar\x20dado:','count','turnCount','catch','bold\x20110px\x20Arial','modGrid','./click.mp3','decodeAudioData','39273685MWCdKY','removeBody','resultFormula','.avatar-option','setData','onclick','material','none','active','advantage','.dice-btn','querySelector','modInput','push','<img\x20src=\x22elfdrowf.png\x22\x20class=\x22avatar-img\x22\x20alt=\x22Drow\x20F\x22>','select','<span\x20style=\x22text-decoration:\x20line-through;\x20opacity:\x200.5;\x22>','normalize','<img\x20src=\x22elfdrowm.png\x22\x20class=\x22avatar-img\x22\x20alt=\x22Drow\x20M\x22>','clearBtn','<img\x20src=\x22elfhighm.png\x22\x20class=\x22avatar-img\x22\x20alt=\x22High\x20Elfo\x22>','Aventura','style','WebGLRenderer','bottom','<div\x20class=\x22tab-avatar\x22>','collide','warn','keyCode','ERRO:\x20Adicione\x20\x27const\x20lastSoundTime\x20=\x20{};\x27\x20no\x20topo\x20do\x20script!','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22rule-tag\x20','renderOrder','Vec3','toggle','ruleSearch','Mesh','<li\x20style=\x27text-align:center;\x20opacity:0.5;\x20padding:20px;\x27>Nenhuma\x20rolagem\x20ainda...</li>','div','historyPanel','value','obj','</span><span\x20class=\x22log-formula\x22>','onkeydown','Média:\x20-','roll-entry','angularVelocity','isGameRunning','parentClass','total','rgba(','Body','.mp3','rule-card','TetrahedronGeometry','avatarGrid','text/plain','<img\x20src=\x22gnomem.png\x22\x20class=\x22avatar-img\x22\x20alt=\x22Gnomo\x22>','target','Item','entries','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22roll-formula\x22>','</div>','global-log-entry','rollen_save_v1','setupModal','join','shadowMap','webkitAudioContext','Scene','Material','Média:\x20','mode-dis','Círculo\x20','keys','modifier','modPickerModal','<img\x20src=\x22halforcm.png\x22\x20class=\x22avatar-img\x22\x20alt=\x22Orc\x20M\x22>','equipment','parse','master','<div\x20class=\x22preview-avatar\x22\x20style=\x22border-color:','action','setHex','middle','addBody','textBaseline','Talento','font','btn-d','appendChild','flex','remove','Erro\x20ao\x20adicionar\x20personagem.\x20Tente\x20\x27Reiniciar\x20Jornada\x27\x20nas\x20configurações.','ondrop','localeCompare','.mod-btn','Subclasse','preventDefault','ondragover','header-','NORMAL','addColorStop','<img\x20src=\x22halfelfm.png\x22\x20class=\x22avatar-img\x22\x20alt=\x22Meio\x20Elfo\x22>','<img\x20src=\x22monster.png\x22\x20class=\x22avatar-img\x22\x20alt=\x22Monstro\x22>','shoot','success','cycleVantBtn','formula','fill','filter','PointLight','...','powerBar','Adicione\x20dados...','classList','height','<img\x20src=\x22aesimarf.png\x22\x20class=\x22avatar-img\x22\x20alt=\x22Aesimar\x20M\x22>','log','shadowColor','map','sort','<img\x20src=\x22boss.png\x22\x20class=\x22avatar-img\x22\x20alt=\x22Chefe\x22>','isArray','render','Erro\x20loadData','volume','./touch.mp3','abs','ondragstart','VANTAGEM','particles','category','quaternion','meta','closest','<img\x20src=\x22tieflingf.png\x22\x20class=\x22avatar-img\x22\x20alt=\x22Tiefling\x20F\x22>','wakeUp','touchstart','OctahedronGeometry','species','toLowerCase','./crit.mp3','selected','stringify','title','forEach','mesh','onended','8aDqiCR','ignored','Histórico\x20limpo!','top','charName','splice','charColorInput','</div>\x20','combat','broadphase','AmbientLight','Plane','AudioContext','DodecahedronGeometry','life','random','<img\x20src=\x22gnomef.png\x22\x20class=\x22avatar-img\x22\x20alt=\x22Gnoma\x22>','fail','solver','campaignNameInput','copy','setSize','setPixelRatio','globalLogModal','./collide1.mp3','replace','button','className','hold.mp3','campaign','tan','contact','ContactMaterial','PCFSoftShadowMap','hold','./start.mp3','addContactMaterial','rgba(255,255,255,1)','Cylinder','CanvasTexture','throw','charTabsContainer','shake-effect','textAlign','0.5','Sprite','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','display',',0.6)','position','getData','</div><span\x20style=\x22color:','color','historyList','appContainer','opacity','<img\x20src=\x22elfhighf.png\x22\x20class=\x22avatar-img\x22\x20alt=\x22High\x20Elfa\x22>','toggleHistoryBtn','castShadow','feat','Ocultar\x20Histórico','<img\x20src=\x22halforcf.png\x22\x20class=\x22avatar-img\x22\x20alt=\x22Orc\x20F\x22>','setFromAxisAngle','emissiveIntensity','SpriteMaterial','name','splash-hidden','toString','ondragend','MeshPhysicalMaterial','.cat-btn','getElementById','now','loop','body','canvasContainer','avatar-option\x20','right','disabled','modDisplay','length','start','<div\x20class=\x22log-meta\x22><span\x20class=\x22log-char-name\x22\x20style=\x22color:\x20','.color-picker-wrapper','crit-success-flash','BoxGeometry','shiftKey','resize','</span><span\x20class=\x22log-time\x22>','getItem','createElement','normal','fillStyle','reverse','rawD20','DOMContentLoaded','Math','<img\x20src=\x22dragonbornm.png\x22\x20class=\x22avatar-img\x22\x20alt=\x22Dracono\x22>','startCampaignBtn','char-tab\x20','rollBtn','#ffffff','degToRad','<div\x20style=\x22font-size:0.75rem;\x20color:#d84315;\x20font-style:italic;\x20margin-bottom:8px;\x20border-bottom:1px\x20dashed\x20rgba(0,0,0,0.1);\x20padding-bottom:4px;\x22>','add','left','<img\x20src=\x22halfelff.png\x22\x20class=\x22avatar-img\x22\x20alt=\x22Meia\x20Elfa\x22>','history','clientWidth','add-char-tab','floor','getDelta','statLuckyName','addEventListener','class','velocity','Raça','Visão\x20Geral','VOLTAR\x20AO\x20JOGO','ATENÇÃO:\x20Isso\x20apagará\x20permanentemente\x20todos\x20os\x20seus\x20heróis\x20e\x20a\x20campanha\x20atual.\x20Deseja\x20continuar?','stopped','aspect','Ambiente','scale','mainSprite','function','</span>','./collide3.mp3','step','Box','val','clientHeight','type','addCharBtn','<img\x20src=\x22aesimarm.png\x22\x20class=\x22avatar-img\x22\x20alt=\x22Aesimar\x20M\x22>','\x22\x20style=\x22background:','nat1-effect','getImpactVelocityAlongNormal','rollMode','width','domElement','./fumble.mp3','Básico','mouseup','7xMsvim','ctrlKey','605350viFKrq','resultTotal','2-digit','log-total','shadowBlur','Zerar\x20histórico?','sum','NFD','Regra','error','undefined','tag-','min','8291502gYsxgF','includes','svg','characters','innerHTML','innerText','updateProjectionMatrix','rulesList','load','747554Dalabq','match','5235273mQtpzb','fumble','open','norm','borderColor',',0)','\x22>0</span>','contains','Erro\x20ao\x20tocar\x20','avatar','getContext','clear','2xOuegn','10YOiRTq','globalLog','Condição','Rolando...','basics','statUnluckyVal','contextmenu','querySelectorAll','DESVANTAGEM','timestamp','Rollen:\x20O\x20carregamento\x20demorou\x20demais.\x20Forçando\x20entrada.','disadvantage','rgba(0,0,0,0.8)','dice-pair-wrapper','./collide2.mp3','activeCharIndex','currentAvatarDisplay','<img\x20src=\x22humanm.png\x22\x20class=\x22avatar-img\x22\x20alt=\x22Humano\x22>','_blank','spell','SphereGeometry','createRadialGradient','charged','./collide4.mp3','Truques\x20(Nível\x200)','crit-fail-flash','settingsMenu','Truque','\x20(D','<img\x20src=\x22bhumanf.png\x22\x20class=\x22avatar-img\x22\x20alt=\x22Humana\x22>','7539904THFoKl','dataTransfer','AdditiveBlending','3173577lCQjBg','statLuckyVal','charCodeAt'];a0_0x2019=function(){return _0x49f9eb;};return a0_0x2019();}function refreshCanvasSize(){const _0x2c9e82=a0_0x59e94c,_0x127e70=document['getElementById']('canvasContainer');if(_0x127e70&&camera&&renderer){const _0x1963bd=_0x127e70[_0x2c9e82(0xfc)],_0x29dd36=_0x127e70[_0x2c9e82(0x113)];renderer[_0x2c9e82(0xa5)](_0x1963bd,_0x29dd36),renderer[_0x2c9e82(0xa6)](Math[_0x2c9e82(0x12e)](window['devicePixelRatio'],1.5)),camera[_0x2c9e82(0x109)]=_0x1963bd/_0x29dd36,camera[_0x2c9e82(0x135)]();if(typeof updateWallPositions===_0x2c9e82(0x10d))updateWallPositions();}}function createDiceGeometry(_0x2ccafb,_0x38b46f){const _0x48894d=a0_0x59e94c,_0x36f590=_0x38b46f;let _0x1a74b8,_0x46d63f,_0x2df9da=0.5;switch(_0x2ccafb){case 0x4:_0x1a74b8=new THREE[(_0x48894d(0x1c4))](_0x36f590),_0x46d63f=new CANNON[(_0x48894d(0x111))](new CANNON[(_0x48894d(0x1af))](_0x36f590*0.75,_0x36f590*0.75,_0x36f590*0.75));break;case 0x6:_0x1a74b8=new THREE[(_0x48894d(0xe5))](_0x36f590,_0x36f590,_0x36f590),_0x46d63f=new CANNON[(_0x48894d(0x111))](new CANNON[(_0x48894d(0x1af))](_0x36f590/0x2,_0x36f590/0x2,_0x36f590/0x2));break;case 0x8:_0x1a74b8=new THREE[(_0x48894d(0x219))](_0x36f590),_0x46d63f=new CANNON[(_0x48894d(0x111))](new CANNON[(_0x48894d(0x1af))](_0x36f590*0.7,_0x36f590*0.7,_0x36f590*0.7));break;case 0xa:case 0x64:_0x1a74b8=new THREE[(_0x48894d(0x15b))](_0x36f590,0x5,0x2),_0x1a74b8[_0x48894d(0x10b)](0x1,1.1,0x1),_0x46d63f=new CANNON[(_0x48894d(0xb6))](0.1,_0x36f590*0x1,_0x36f590*1.1,0x5),_0x2df9da=0.4;break;case 0xc:_0x1a74b8=new THREE[(_0x48894d(0x230))](_0x36f590),_0x46d63f=new CANNON[(_0x48894d(0x111))](new CANNON[(_0x48894d(0x1af))](_0x36f590*0.85,_0x36f590*0.85,_0x36f590*0.85)),_0x2df9da=0.6;break;case 0x14:_0x1a74b8=new THREE['IcosahedronGeometry'](_0x36f590),_0x46d63f=new CANNON[(_0x48894d(0x111))](new CANNON[(_0x48894d(0x1af))](_0x36f590*0.8,_0x36f590*0.8,_0x36f590*0.8)),_0x2df9da=0.6;break;default:_0x1a74b8=new THREE[(_0x48894d(0xe5))](_0x36f590,_0x36f590,_0x36f590),_0x46d63f=new CANNON['Box'](new CANNON['Vec3'](_0x36f590/0x2,_0x36f590/0x2,_0x36f590/0x2));}return{'geometry':_0x1a74b8,'shape':_0x46d63f,'angularDamping':_0x2df9da};}function addDice(_0xdb44e2){const _0x129231=a0_0x59e94c;if(!scene)return;const _0x447ac8=campaign[_0x129231(0x132)][activeCharIndex],_0x101514=_0x447ac8?_0x447ac8['color']:diceConfigs[_0xdb44e2][_0x129231(0xc4)];try{const {geometry:_0x59f75e,shape:_0x4545d5,angularDamping:_0x5e2c6c}=createDiceGeometry(_0xdb44e2,1.8),_0x512b7f=new THREE[(_0x129231(0xd5))]({'color':_0x101514,'metalness':0.1,'roughness':0.2,'clearcoat':0x1,'flatShading':!![]}),_0x337767=new THREE[(_0x129231(0x1b2))](_0x59f75e,_0x512b7f);_0x337767[_0x129231(0xca)]=!![],scene['add'](_0x337767);const _0x524ba4=new CANNON[(_0x129231(0x1c1))]({'mass':0x5,'shape':_0x4545d5,'linearDamping':0.5,'angularDamping':_0x5e2c6c,'material':matDice});_0x524ba4[_0x129231(0xc1)][_0x129231(0x179)]((Math[_0x129231(0x9f)]()-0.5)*0x8,0xe,(Math[_0x129231(0x9f)]()-0.5)*0x8),_0x524ba4[_0x129231(0x213)][_0x129231(0x179)](Math[_0x129231(0x9f)](),Math[_0x129231(0x9f)](),Math[_0x129231(0x9f)](),Math[_0x129231(0x9f)]()),_0x524ba4[_0x129231(0x1bc)][_0x129231(0x179)](Math[_0x129231(0x9f)]()*0xa,Math[_0x129231(0x9f)]()*0xa,Math[_0x129231(0x9f)]()*0xa),_0x524ba4[_0x129231(0x101)](_0x129231(0x1a9),handleDiceCollision),world[_0x129231(0x1e3)](_0x524ba4),diceObjects[_0x129231(0x19c)]({'mesh':_0x337767,'body':_0x524ba4,'type':_0xdb44e2,'stopped':![]}),updateDiceButtonUI(_0xdb44e2,0x1),clearMagicEffects();}catch(_0x45a63d){console[_0x129231(0x12b)](_0x129231(0x187),_0x45a63d);}}function createSparkleTexture(){const _0x14dc46=a0_0x59e94c,_0xdc8a54=document[_0x14dc46(0xea)]('canvas');_0xdc8a54[_0x14dc46(0x11b)]=0x20,_0xdc8a54[_0x14dc46(0x202)]=0x20;const _0x47d3b5=_0xdc8a54[_0x14dc46(0x144)]('2d'),_0x95b9bd=_0x47d3b5[_0x14dc46(0x15c)](0x10,0x10,0x0,0x10,0x10,0x10);return _0x95b9bd[_0x14dc46(0x1f4)](0x0,_0x14dc46(0xb5)),_0x95b9bd[_0x14dc46(0x1f4)](0x1,'rgba(255,255,255,0)'),_0x47d3b5[_0x14dc46(0xec)]=_0x95b9bd,_0x47d3b5[_0x14dc46(0x171)](0x0,0x0,0x20,0x20),new THREE[(_0x14dc46(0xb7))](_0xdc8a54);}function createNumberLabel(_0x4d6ea5,_0x40e581){const _0x34480b=a0_0x59e94c,_0x52fdf8=document[_0x34480b(0xea)]('canvas'),_0x3a2c17=0x100;_0x52fdf8[_0x34480b(0x11b)]=_0x3a2c17,_0x52fdf8['height']=_0x3a2c17;const _0xea1948=_0x52fdf8['getContext']('2d'),_0x557346=parseInt(_0x40e581[_0x34480b(0x181)](0x1,0x3),0x10),_0x3e57d8=parseInt(_0x40e581[_0x34480b(0x181)](0x3,0x5),0x10),_0x7c3c65=parseInt(_0x40e581[_0x34480b(0x181)](0x5,0x7),0x10),_0x202a03=_0xea1948[_0x34480b(0x15c)](_0x3a2c17/0x2,_0x3a2c17/0x2,0x14,_0x3a2c17/0x2,_0x3a2c17/0x2,0x6e);_0x202a03[_0x34480b(0x1f4)](0x0,_0x34480b(0x1c0)+_0x557346+','+_0x3e57d8+','+_0x7c3c65+_0x34480b(0xc0)),_0x202a03[_0x34480b(0x1f4)](0x1,_0x34480b(0x1c0)+_0x557346+','+_0x3e57d8+','+_0x7c3c65+_0x34480b(0x13f)),_0xea1948['fillStyle']=_0x202a03,_0xea1948[_0x34480b(0x171)](0x0,0x0,_0x3a2c17,_0x3a2c17),_0xea1948[_0x34480b(0x1e6)]=_0x34480b(0x18b),_0xea1948[_0x34480b(0xbb)]='center',_0xea1948[_0x34480b(0x1e4)]=_0x34480b(0x1e2),_0xea1948[_0x34480b(0x205)]=_0x34480b(0x153),_0xea1948[_0x34480b(0x126)]=0xa,_0xea1948[_0x34480b(0xec)]=_0x34480b(0xf5),_0xea1948[_0x34480b(0x17d)](_0x4d6ea5,_0x3a2c17/0x2,_0x3a2c17/0x2);const _0x43d22f=new THREE[(_0x34480b(0xd0))]({'map':new THREE[(_0x34480b(0xb7))](_0x52fdf8),'transparent':!![],'depthTest':![]}),_0x59f3c1=new THREE[(_0x34480b(0xbd))](_0x43d22f);return _0x59f3c1[_0x34480b(0x10b)][_0x34480b(0x179)](0.1,0.1,0x1),_0x59f3c1[_0x34480b(0x1ae)]=0x3e7,_0x59f3c1;}function showFloatingResult(_0x15a4b1,_0x2147a4){const _0x4826f6=a0_0x59e94c,_0x3ce3e9=campaign[_0x4826f6(0x132)][activeCharIndex],_0x4dfbaf=_0x3ce3e9?_0x3ce3e9[_0x4826f6(0xc4)]:_0x4826f6(0xf5),_0x5667aa=createNumberLabel(_0x2147a4[_0x4826f6(0xd3)](),_0x4dfbaf);_0x5667aa[_0x4826f6(0xc1)][_0x4826f6(0xa4)](_0x15a4b1[_0x4826f6(0x221)][_0x4826f6(0xc1)]),_0x5667aa[_0x4826f6(0xc1)]['y']+=0.8,scene[_0x4826f6(0xf8)](_0x5667aa),magicEffects[_0x4826f6(0x19c)]({'mainSprite':_0x5667aa,'life':0x0,'maxLife':0x64,'color':_0x4dfbaf,'particles':[]});if(_0x15a4b1[_0x4826f6(0x114)]===0x14){if(_0x2147a4===0x14)hasCritHappened=!![],playSound('crit'),document['body'][_0x4826f6(0x201)][_0x4826f6(0x1ea)](_0x4826f6(0x118)),document[_0x4826f6(0xda)][_0x4826f6(0x201)][_0x4826f6(0xf8)](_0x4826f6(0xe4),'shake-effect'),setTimeout(()=>{const _0x3d20d2=_0x4826f6;document[_0x3d20d2(0xda)]['classList'][_0x3d20d2(0x1ea)]('crit-success-flash',_0x3d20d2(0xba));},0xfa0);else _0x2147a4===0x1&&!hasCritHappened&&(playSound(_0x4826f6(0x13b)),document['body'][_0x4826f6(0x201)][_0x4826f6(0xf8)]('nat1-effect','shake-effect'),setTimeout(()=>{const _0x1f46c9=_0x4826f6;if(!hasCritHappened)document['body']['classList'][_0x1f46c9(0x1ea)](_0x1f46c9(0x118),_0x1f46c9(0xba));},0xfa0));}}function clearMagicEffects(){const _0x5ab8fc=a0_0x59e94c;magicEffects[_0x5ab8fc(0x220)](_0x4df78e=>{const _0x22ceb1=_0x5ab8fc;scene['remove'](_0x4df78e[_0x22ceb1(0x10c)]),_0x4df78e[_0x22ceb1(0x211)]['forEach'](_0x554cf7=>scene['remove'](_0x554cf7['mesh']));}),magicEffects=[];}let chargeAnimId=null,lastFrameTime=0x0;function startCharging(){const _0x4cb8c8=a0_0x59e94c;if(diceObjects['length']===0x0||isRolling)return;isPressing=!![],clearMagicEffects(),pressPower=0.3,playSound(_0x4cb8c8(0xb2));const _0x42f43d=document[_0x4cb8c8(0xd7)](_0x4cb8c8(0x1ff)),_0x243411=document[_0x4cb8c8(0xd7)](_0x4cb8c8(0xf4));if(chargeAnimId)cancelAnimationFrame(chargeAnimId);const _0x34ddf7=0x3e8,_0x58e5b1=1.5,_0x497cef=_0x58e5b1-0.3;lastFrameTime=performance[_0x4cb8c8(0xd8)]();const _0x355b80=_0x24c824=>{const _0x370955=_0x4cb8c8;if(!isPressing)return;const _0x463e4d=_0x24c824-lastFrameTime;lastFrameTime=_0x24c824,pressPower+=_0x497cef/_0x34ddf7*_0x463e4d;if(pressPower>=_0x58e5b1)pressPower=_0x58e5b1;const _0x443696=Math[_0x370955(0x12e)](pressPower/_0x58e5b1*0x64,0x64);_0x42f43d[_0x370955(0x1a5)][_0x370955(0x11b)]=_0x443696+'%';if(_0x443696>=0x64)_0x243411[_0x370955(0x201)][_0x370955(0xf8)](_0x370955(0x15d));if(pressPower<_0x58e5b1)chargeAnimId=requestAnimationFrame(_0x355b80);};chargeAnimId=requestAnimationFrame(_0x355b80);}function releaseRoll(){const _0x2a280b=a0_0x59e94c;if(!isPressing)return;isPressing=![],chargeAnimId&&(cancelAnimationFrame(chargeAnimId),chargeAnimId=null),stopHoldSound(),document['getElementById'](_0x2a280b(0x1ff))[_0x2a280b(0x1a5)]['width']='0%',document[_0x2a280b(0xd7)](_0x2a280b(0xf4))[_0x2a280b(0x201)][_0x2a280b(0x1ea)](_0x2a280b(0x15d)),diceObjects[_0x2a280b(0xe0)]>0x0&&!isRolling&&(playSound(_0x2a280b(0x1f7)),rollAllDice(pressPower)),pressPower=0x0;}function rollAllDice(_0x282f04=0.3){const _0x3fb28a=a0_0x59e94c;if(diceObjects[_0x3fb28a(0xe0)]===0x0)return;isRolling=!![],updateResultDisplay(_0x3fb28a(0x14a),_0x3fb28a(0x1fe)),playSound(_0x3fb28a(0xb8)),diceObjects['forEach']((_0xeb95b6,_0x4c66db)=>{const _0x2431e1=_0x3fb28a;_0xeb95b6[_0x2431e1(0x108)]=![];const _0x2c4dec=0xa,_0x5ad6ee=0xf*_0x282f04,_0x5afd93=_0x2c4dec+_0x5ad6ee,_0x241271=0x8+0xa*_0x282f04,_0x3b92cf=0xf+0x1e*_0x282f04;_0xeb95b6[_0x2431e1(0xda)][_0x2431e1(0x103)][_0x2431e1(0x179)](0x0,0x0,0x0),_0xeb95b6['body']['angularVelocity']['set'](0x0,0x0,0x0),_0xeb95b6[_0x2431e1(0xda)]['position']['y']=Math[_0x2431e1(0x17e)](_0xeb95b6['body'][_0x2431e1(0xc1)]['y'],0x5),_0xeb95b6[_0x2431e1(0xda)]['velocity'][_0x2431e1(0x179)]((Math[_0x2431e1(0x9f)]()-0.5)*_0x5afd93,_0x241271,(Math[_0x2431e1(0x9f)]()-0.5)*_0x5afd93),_0xeb95b6['body']['angularVelocity'][_0x2431e1(0x179)]((Math['random']()-0.5)*_0x3b92cf,(Math[_0x2431e1(0x9f)]()-0.5)*_0x3b92cf,(Math['random']()-0.5)*_0x3b92cf),_0xeb95b6[_0x2431e1(0xda)][_0x2431e1(0x217)]();}),requestAnimationFrame(checkDiceStopped);}function checkDiceStopped(){const _0x24e109=a0_0x59e94c;if(!isRolling)return;let _0x4b2c78=!![];diceObjects[_0x24e109(0x220)](_0x46d6d6=>{const _0x54d70e=_0x24e109;if(_0x46d6d6['body'][_0x54d70e(0x103)]['norm']()>0.1||_0x46d6d6[_0x54d70e(0xda)]['angularVelocity'][_0x54d70e(0x13d)]()>0.1)_0x4b2c78=![];});if(_0x4b2c78)setTimeout(calculateResults,0xc8);else requestAnimationFrame(checkDiceStopped);}function calculateResults(){const _0xa43ad6=a0_0x59e94c;let _0x33b831=0x0,_0x434f02=[],_0x5d4221=[],_0x418d4a=![],_0x2b34f7=![];const _0x38ed49=document['getElementById']('modInput');let _0x213a31=parseInt(_0x38ed49[_0xa43ad6(0x1b6)])||0x0;const _0x3e8e34=diceObjects[_0xa43ad6(0x206)](_0x2f1b08=>{const _0x12b99a=_0xa43ad6,_0x1a3d3d=_0x2f1b08[_0x12b99a(0x114)]===0x64?(Math[_0x12b99a(0xfe)](Math[_0x12b99a(0x9f)]()*0xa)+0x1)*0xa:Math[_0x12b99a(0xfe)](Math[_0x12b99a(0x9f)]()*_0x2f1b08[_0x12b99a(0x114)])+0x1,_0x270b03={'val':_0x1a3d3d,'type':_0x2f1b08['type'],'obj':_0x2f1b08,'ignored':![]};if(_0x2f1b08[_0x12b99a(0x114)]===0x14)_0x5d4221['push'](_0x270b03);return _0x270b03;});if(rollMode!==_0xa43ad6(0xeb)&&_0x5d4221[_0xa43ad6(0xe0)]>=0x2){rollMode===_0xa43ad6(0x198)?_0x5d4221['sort']((_0x1e1def,_0x2b935d)=>_0x2b935d[_0xa43ad6(0x112)]-_0x1e1def[_0xa43ad6(0x112)]):_0x5d4221[_0xa43ad6(0x207)]((_0x55c9ed,_0x452db2)=>_0x55c9ed[_0xa43ad6(0x112)]-_0x452db2[_0xa43ad6(0x112)]);for(let _0x1c59c4=0x1;_0x1c59c4<_0x5d4221[_0xa43ad6(0xe0)];_0x1c59c4++){_0x5d4221[_0x1c59c4][_0xa43ad6(0x224)]=!![];}}_0x3e8e34[_0xa43ad6(0x220)](_0x803147=>{const _0x2628a5=_0xa43ad6;if(!_0x803147[_0x2628a5(0x224)]){_0x33b831+=_0x803147['val'];if(_0x803147[_0x2628a5(0x114)]===0x14){if(_0x803147[_0x2628a5(0x112)]===0x14)_0x418d4a=!![];if(_0x803147[_0x2628a5(0x112)]===0x1)_0x2b34f7=!![];}const _0x20e972=_0x803147[_0x2628a5(0x114)]===0x64?'%':_0x803147[_0x2628a5(0x114)];_0x434f02[_0x2628a5(0x19c)](_0x803147['val']+_0x2628a5(0x163)+_0x20e972+')'),_0x803147[_0x2628a5(0x1b7)][_0x2628a5(0x221)][_0x2628a5(0x195)][_0x2628a5(0xc7)]=0x1,_0x803147[_0x2628a5(0x1b7)][_0x2628a5(0x221)][_0x2628a5(0x195)][_0x2628a5(0xcf)]=0x0;}else _0x803147[_0x2628a5(0x1b7)][_0x2628a5(0x221)][_0x2628a5(0x195)][_0x2628a5(0xc7)]=0.2,_0x803147[_0x2628a5(0x1b7)][_0x2628a5(0x221)][_0x2628a5(0x195)]['color'][_0x2628a5(0x1e1)](0x333333),_0x434f02[_0x2628a5(0x19c)](_0x2628a5(0x19f)+_0x803147['val']+_0x2628a5(0x10e));showFloatingResult(_0x803147['obj'],_0x803147[_0x2628a5(0x112)]);}),_0x33b831+=_0x213a31;let _0x244baa=_0x434f02[_0xa43ad6(0x1d0)]('\x20+\x20');if(_0x213a31!==0x0)_0x244baa+='\x20'+(_0x213a31>0x0?'+':'')+_0x213a31+'\x20(Mod)';isRolling=![],updateResultDisplay(_0x244baa,_0x33b831);if(_0x418d4a)triggerCritEffect(_0xa43ad6(0x1f8));else{if(_0x2b34f7)triggerCritEffect(_0xa43ad6(0xa1));}const _0x53d1a6=campaign[_0xa43ad6(0x132)][activeCharIndex];if(_0x53d1a6){const _0x575053=_0x244baa[_0xa43ad6(0xa9)](/<[^>]*>?/gm,'');saveHistory(_0x53d1a6,_0x33b831,_0x575053);if(!campaign['globalLog'])campaign['globalLog']=[];const _0xbb16f5=_0x3e8e34['find'](_0x21d3c2=>_0x21d3c2[_0xa43ad6(0x114)]===0x14&&!_0x21d3c2[_0xa43ad6(0x224)]);campaign['globalLog'][_0xa43ad6(0x19c)]({'charName':_0x53d1a6[_0xa43ad6(0xd1)],'charColor':_0x53d1a6[_0xa43ad6(0xc4)],'formula':_0x575053,'total':_0x33b831,'rawD20':_0xbb16f5?_0xbb16f5[_0xa43ad6(0x112)]:null,'timestamp':new Date()[_0xa43ad6(0x174)]([],{'hour':_0xa43ad6(0x124),'minute':_0xa43ad6(0x124)})});}saveData();}function triggerCritEffect(_0x5ed446){const _0x234e0a=a0_0x59e94c,_0x267f5e=document[_0x234e0a(0xda)];_0x5ed446===_0x234e0a(0x1f8)?(_0x267f5e[_0x234e0a(0x201)]['add']('crit-success-flash'),setTimeout(()=>_0x267f5e[_0x234e0a(0x201)][_0x234e0a(0x1ea)](_0x234e0a(0xe4)),0x3e8)):(_0x267f5e[_0x234e0a(0x201)][_0x234e0a(0xf8)](_0x234e0a(0x160),_0x234e0a(0xba)),setTimeout(()=>_0x267f5e[_0x234e0a(0x201)]['remove'](_0x234e0a(0x160),_0x234e0a(0xba)),0x1f4));}function clearDice(){const _0x5cf7e1=a0_0x59e94c;diceObjects[_0x5cf7e1(0x220)](_0x5f10a8=>{const _0x357eec=_0x5cf7e1;if(_0x5f10a8[_0x357eec(0x221)])scene[_0x357eec(0x1ea)](_0x5f10a8['mesh']);if(_0x5f10a8['body'])world[_0x357eec(0x190)](_0x5f10a8[_0x357eec(0xda)]);}),diceObjects=[],clearMagicEffects(),diceTypes['flat']()['forEach'](_0x3d9337=>updateDiceButtonUI(_0x3d9337,0x0,!![])),updateResultDisplay(_0x5cf7e1(0x200),'0'),isRolling=![],playSound(_0x5cf7e1(0x178));}function saveHistory(_0x5d6259,_0x38bad7,_0x4d2e55){const _0x2be4b0=a0_0x59e94c;if(!_0x5d6259['history'])_0x5d6259[_0x2be4b0(0xfb)]=[];_0x5d6259[_0x2be4b0(0xfb)][_0x2be4b0(0x19c)]({'turn':_0x5d6259[_0x2be4b0(0x189)]||0x1,'total':_0x38bad7,'formula':_0x4d2e55}),updateHistoryUI();}function updateHistoryUI(){const _0xe68bf6=a0_0x59e94c,_0x3a8327=campaign[_0xe68bf6(0x132)][activeCharIndex],_0x2e2b0d=document['getElementById'](_0xe68bf6(0xc5));if(!_0x3a8327||!_0x2e2b0d)return;_0x2e2b0d[_0xe68bf6(0x133)]='';const _0x1e9872=[..._0x3a8327['history']]['reverse']();if(_0x1e9872['length']===0x0){_0x2e2b0d['innerHTML']=_0xe68bf6(0x1b3);return;}_0x1e9872['forEach'](_0x357298=>{const _0x123d56=_0xe68bf6,_0x363c85=document['createElement']('li');_0x363c85[_0x123d56(0xab)]=_0x123d56(0x1bb),_0x363c85[_0x123d56(0x133)]=_0x123d56(0x1cb)+_0x357298[_0x123d56(0x1fa)]+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22roll-equals\x22>=</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22roll-total\x22\x20style=\x22color:'+_0x3a8327[_0x123d56(0xc4)]+'\x22>'+_0x357298[_0x123d56(0x1bf)]+_0x123d56(0x175),_0x2e2b0d[_0x123d56(0x1e8)](_0x363c85);});}function toggleHistory(){const _0x13d7b9=a0_0x59e94c,_0x3b278b=document[_0x13d7b9(0xd7)](_0x13d7b9(0x1b5)),_0x5f3972=document[_0x13d7b9(0xd7)](_0x13d7b9(0xc9));if(!_0x3b278b||!_0x5f3972)return;const _0x2869ae=_0x3b278b[_0x13d7b9(0x201)][_0x13d7b9(0x1b0)]('open');_0x5f3972[_0x13d7b9(0x134)]=_0x2869ae?_0x13d7b9(0xcc):'Ver\x20Histórico',playSound(_0x13d7b9(0x170));}function animate(){const _0x15a134=a0_0x59e94c;requestAnimationFrame(animate);const _0x3254f3=clock[_0x15a134(0xff)]();if(world)world[_0x15a134(0x110)](0x1/0x3c,_0x3254f3,0x3);diceObjects[_0x15a134(0x220)](_0x70e96d=>{const _0x5d59b9=_0x15a134;_0x70e96d[_0x5d59b9(0x221)]&&_0x70e96d[_0x5d59b9(0xda)]&&(_0x70e96d['mesh']['position'][_0x5d59b9(0xa4)](_0x70e96d[_0x5d59b9(0xda)]['position']),_0x70e96d['mesh']['quaternion']['copy'](_0x70e96d[_0x5d59b9(0xda)][_0x5d59b9(0x213)]));});for(let _0x2bb988=magicEffects[_0x15a134(0xe0)]-0x1;_0x2bb988>=0x0;_0x2bb988--){const _0x1acf31=magicEffects[_0x2bb988];_0x1acf31[_0x15a134(0x231)]++;if(_0x1acf31[_0x15a134(0x231)]<0x64){_0x1acf31[_0x15a134(0x10c)]['position']['y']+=0.015;if(_0x1acf31[_0x15a134(0x231)]<0x14){const _0x3dadad=_0x1acf31[_0x15a134(0x231)]/0x14;_0x1acf31[_0x15a134(0x10c)][_0x15a134(0x10b)]['set'](_0x3dadad*2.5,_0x3dadad*2.5,0x1),_0x1acf31[_0x15a134(0x10c)][_0x15a134(0x195)]['opacity']=_0x3dadad;}else{if(_0x1acf31['life']>0x50)_0x1acf31[_0x15a134(0x10c)][_0x15a134(0x195)]['opacity']=(0x64-_0x1acf31[_0x15a134(0x231)])/0x14;}}if(_0x1acf31[_0x15a134(0x231)]<0x3c&&Math[_0x15a134(0x9f)]()>0.3){const _0x3fcc73=new THREE[(_0x15a134(0xd0))]({'map':sparkleTexture,'transparent':!![],'color':_0x1acf31[_0x15a134(0xc4)],'opacity':0.8,'blending':THREE[_0x15a134(0x167)]}),_0xb80d2c=new THREE[(_0x15a134(0xbd))](_0x3fcc73);_0xb80d2c['position'][_0x15a134(0xa4)](_0x1acf31[_0x15a134(0x10c)][_0x15a134(0xc1)]),_0xb80d2c[_0x15a134(0xc1)]['x']+=(Math[_0x15a134(0x9f)]()-0.5)*0.5,_0xb80d2c['position']['y']-=0.2,_0xb80d2c[_0x15a134(0x10b)][_0x15a134(0x179)](0.3,0.3,0x1),scene[_0x15a134(0xf8)](_0xb80d2c),_0x1acf31['particles'][_0x15a134(0x19c)]({'mesh':_0xb80d2c,'age':0x0});}for(let _0x48e7b1=_0x1acf31['particles']['length']-0x1;_0x48e7b1>=0x0;_0x48e7b1--){const _0x5c2264=_0x1acf31[_0x15a134(0x211)][_0x48e7b1];_0x5c2264['age']++,_0x5c2264[_0x15a134(0x221)]['position']['y']-=0.005,_0x5c2264['mesh'][_0x15a134(0x195)]['opacity']-=0.03,_0x5c2264[_0x15a134(0x221)][_0x15a134(0x10b)]['multiplyScalar'](0.95),_0x5c2264[_0x15a134(0x221)][_0x15a134(0x195)][_0x15a134(0xc7)]<=0x0&&(scene[_0x15a134(0x1ea)](_0x5c2264[_0x15a134(0x221)]),_0x1acf31['particles']['splice'](_0x48e7b1,0x1));}_0x1acf31[_0x15a134(0x231)]>=0x64&&_0x1acf31[_0x15a134(0x211)][_0x15a134(0xe0)]===0x0&&(scene[_0x15a134(0x1ea)](_0x1acf31[_0x15a134(0x10c)]),magicEffects[_0x15a134(0x228)](_0x2bb988,0x1));}if(renderer&&scene&&camera)renderer[_0x15a134(0x20a)](scene,camera);}document['addEventListener'](a0_0x59e94c(0x170),_0x572fb1=>{const _0x3acdfe=a0_0x59e94c;if(_0x572fb1['target']['id']===_0x3acdfe(0xf2)){playSound(_0x3acdfe(0xe1));return;}if(_0x572fb1[_0x3acdfe(0x1c8)][_0x3acdfe(0x215)](_0x3acdfe(0x184))||_0x572fb1[_0x3acdfe(0x1c8)][_0x3acdfe(0x215)](_0x3acdfe(0x192))){playSound('touch');return;}if(_0x572fb1[_0x3acdfe(0x1c8)]['closest']('#rollBtn'))return;if(_0x572fb1[_0x3acdfe(0x1c8)][_0x3acdfe(0x215)](_0x3acdfe(0xaa))||_0x572fb1[_0x3acdfe(0x1c8)][_0x3acdfe(0x215)](_0x3acdfe(0x199))||_0x572fb1[_0x3acdfe(0x1c8)][_0x3acdfe(0x215)](_0x3acdfe(0x182))||_0x572fb1['target']['closest'](_0x3acdfe(0x19e))||_0x572fb1['target'][_0x3acdfe(0x215)]('i'))playSound(_0x3acdfe(0x170));setupModPicker();});function handleDiceCollision(_0x1296d4){const _0x1d6954=a0_0x59e94c;if(typeof lastSoundTime==='undefined'){console[_0x1d6954(0x12b)](_0x1d6954(0x1ac));return;}let _0x3820e3=0x0;if(_0x1296d4[_0x1d6954(0xaf)]&&_0x1296d4[_0x1d6954(0xaf)][_0x1d6954(0x119)])_0x3820e3=Math[_0x1d6954(0x20e)](_0x1296d4['contact'][_0x1d6954(0x119)]());else _0x1296d4['contact']&&_0x1296d4[_0x1d6954(0xaf)]['bi']&&_0x1296d4[_0x1d6954(0xaf)]['bj']&&(_0x3820e3=0x1);if(_0x3820e3<0.8)return;const _0xac4c17=_0x1296d4[_0x1d6954(0xda)]['id'],_0x37992a=Date[_0x1d6954(0xd8)]();if(lastSoundTime[_0xac4c17]&&_0x37992a-lastSoundTime[_0xac4c17]<0x32)return;lastSoundTime[_0xac4c17]=_0x37992a;let _0x88a3e0=Math[_0x1d6954(0x12e)](_0x3820e3/0xf,0x1);playSound(_0x1d6954(0x1a9),_0x88a3e0);}function setupModPicker(){const _0x4ecd6=a0_0x59e94c,_0x3aacd3=document[_0x4ecd6(0xd7)](_0x4ecd6(0x18c));if(!_0x3aacd3)return;_0x3aacd3['innerHTML']='';for(let _0x5c69ca=-0xa;_0x5c69ca<=0xa;_0x5c69ca++){const _0x5bbbbb=document['createElement']('button');_0x5bbbbb['className']='mod-btn',_0x5bbbbb[_0x4ecd6(0x134)]=(_0x5c69ca>0x0?'+':'')+_0x5c69ca,_0x5bbbbb[_0x4ecd6(0x194)]=()=>selectMod(_0x5c69ca),_0x3aacd3[_0x4ecd6(0x1e8)](_0x5bbbbb);}}function toggleModPicker(){const _0x1b5863=a0_0x59e94c,_0x46f9e5=document['getElementById'](_0x1b5863(0x1da)),_0x14d4e8=_0x46f9e5['style']['display']===_0x1b5863(0x196);_0x46f9e5['style'][_0x1b5863(0xbf)]=_0x14d4e8?_0x1b5863(0x1e9):_0x1b5863(0x196),_0x14d4e8&&(playSound(_0x1b5863(0x170)),highlightActiveMod());}function selectMod(_0x2489fe){const _0x3909b3=a0_0x59e94c,_0x18f706=document[_0x3909b3(0xd7)]('modInput'),_0x2b5a51=document[_0x3909b3(0xd7)](_0x3909b3(0xdf));_0x18f706[_0x3909b3(0x1b6)]=_0x2489fe,_0x2b5a51[_0x3909b3(0x134)]=(_0x2489fe>0x0?'+':'')+_0x2489fe;if(campaign['characters'][activeCharIndex])campaign[_0x3909b3(0x132)][activeCharIndex]['modifier']=_0x2489fe;saveData(),toggleModPicker(),playSound(_0x3909b3(0x178));}function highlightActiveMod(){const _0x3fca44=a0_0x59e94c,_0x17a167=parseInt(document[_0x3fca44(0xd7)](_0x3fca44(0x19b))[_0x3fca44(0x1b6)])||0x0;document[_0x3fca44(0x14e)](_0x3fca44(0x1ee))[_0x3fca44(0x220)](_0x4cede2=>{const _0x143301=_0x3fca44,_0x12b8da=parseInt(_0x4cede2['innerText']);_0x4cede2['classList'][_0x143301(0x1b0)](_0x143301(0x197),_0x12b8da===_0x17a167);});}function setRollMode(_0x3f137c){const _0x2daef0=a0_0x59e94c;rollMode=_0x3f137c;if(campaign[_0x2daef0(0x132)][activeCharIndex])campaign[_0x2daef0(0x132)][activeCharIndex][_0x2daef0(0x11a)]=_0x3f137c;const _0xd288af=document['getElementById'](_0x2daef0(0x1f9));if(!_0xd288af)return;_0xd288af['classList']['remove'](_0x2daef0(0x186),_0x2daef0(0x173),_0x2daef0(0x1d6));if(_0x3f137c===_0x2daef0(0xeb))_0xd288af[_0x2daef0(0x134)]=_0x2daef0(0x1f3),_0xd288af[_0x2daef0(0x201)][_0x2daef0(0xf8)](_0x2daef0(0x186));else{if(_0x3f137c===_0x2daef0(0x198))_0xd288af[_0x2daef0(0x134)]=_0x2daef0(0x210),_0xd288af['classList'][_0x2daef0(0xf8)](_0x2daef0(0x173));else _0x3f137c===_0x2daef0(0x152)&&(_0xd288af[_0x2daef0(0x134)]=_0x2daef0(0x14f),_0xd288af['classList']['add'](_0x2daef0(0x1d6)));}}function cycleRollMode(){const _0x48ce91=a0_0x59e94c;playSound(_0x48ce91(0x170));if(rollMode===_0x48ce91(0xeb))setRollMode(_0x48ce91(0x198));else{if(rollMode===_0x48ce91(0x198))setRollMode(_0x48ce91(0x152));else setRollMode('normal');}}function openGlobalLog(){const _0x4e83ed=a0_0x59e94c,_0x2c6352=document['getElementById'](_0x4e83ed(0xa7)),_0x48fdd4=document[_0x4e83ed(0xd7)](_0x4e83ed(0x17b));if(!campaign['globalLog'])campaign[_0x4e83ed(0x148)]=[];let _0x3aab14={};campaign[_0x4e83ed(0x148)][_0x4e83ed(0x220)](_0x2886b2=>{const _0x12851c=_0x4e83ed;if(_0x2886b2['rawD20']!==null&&_0x2886b2['rawD20']!==undefined){if(!_0x3aab14[_0x2886b2[_0x12851c(0x227)]])_0x3aab14[_0x2886b2[_0x12851c(0x227)]]={'sum':0x0,'count':0x0};_0x3aab14[_0x2886b2[_0x12851c(0x227)]][_0x12851c(0x128)]+=_0x2886b2[_0x12851c(0xee)],_0x3aab14[_0x2886b2[_0x12851c(0x227)]][_0x12851c(0x188)]++;}});let _0x2abc3b=-0x1,_0x1ea02b=0x15,_0x42330e='--',_0x508e10='--';for(const [_0x1e1d75,_0x14e7ec]of Object['entries'](_0x3aab14)){if(_0x14e7ec[_0x4e83ed(0x188)]>0x0){const _0x14f89c=_0x14e7ec[_0x4e83ed(0x128)]/_0x14e7ec['count'];_0x14f89c>_0x2abc3b&&(_0x2abc3b=_0x14f89c,_0x42330e=_0x1e1d75),_0x14f89c<_0x1ea02b&&(_0x1ea02b=_0x14f89c,_0x508e10=_0x1e1d75);}}document['getElementById'](_0x4e83ed(0x100))[_0x4e83ed(0x134)]=_0x42330e,document[_0x4e83ed(0xd7)](_0x4e83ed(0x169))[_0x4e83ed(0x134)]=_0x2abc3b>-0x1?'Média:\x20'+_0x2abc3b[_0x4e83ed(0x17f)](0x1):'Média:\x20-',document[_0x4e83ed(0xd7)](_0x4e83ed(0x176))[_0x4e83ed(0x134)]=_0x508e10,document[_0x4e83ed(0xd7)](_0x4e83ed(0x14c))[_0x4e83ed(0x134)]=_0x1ea02b<0x15?_0x4e83ed(0x1d5)+_0x1ea02b[_0x4e83ed(0x17f)](0x1):_0x4e83ed(0x1ba),_0x48fdd4[_0x4e83ed(0x133)]='',[...campaign[_0x4e83ed(0x148)]][_0x4e83ed(0xed)]()[_0x4e83ed(0x220)](_0x2fafd6=>{const _0x4e119b=_0x4e83ed,_0x34b7f0=document[_0x4e119b(0xea)]('li');_0x34b7f0['className']=_0x4e119b(0x1cd);let _0x1fb053=_0x4e119b(0x125);if(_0x2fafd6[_0x4e119b(0xee)]===0x14)_0x1fb053+=_0x4e119b(0x177);if(_0x2fafd6[_0x4e119b(0xee)]===0x1)_0x1fb053+='\x20log-crit-fail';_0x34b7f0[_0x4e119b(0x133)]=_0x4e119b(0xe2)+_0x2fafd6['charColor']+'\x22>'+_0x2fafd6[_0x4e119b(0x227)]+_0x4e119b(0xe8)+_0x2fafd6[_0x4e119b(0x150)]+_0x4e119b(0x172)+_0x1fb053+'\x22>'+_0x2fafd6[_0x4e119b(0x1bf)]+_0x4e119b(0x1b8)+_0x2fafd6['formula']+'</span></div>',_0x48fdd4[_0x4e119b(0x1e8)](_0x34b7f0);}),_0x2c6352['style'][_0x4e83ed(0xbf)]=_0x4e83ed(0x1e9),playSound('click');}function openCompendium(){const _0x18894e=a0_0x59e94c,_0x54f9f0=document[_0x18894e(0xd7)]('compendiumModal');if(_0x54f9f0){_0x54f9f0[_0x18894e(0x1a5)][_0x18894e(0xbf)]='flex';if(typeof rulesData!==_0x18894e(0x12c))renderRules(rulesData);playSound(_0x18894e(0x170));}}function getLevelValue(_0x2347f6){const _0x446eff=a0_0x59e94c;if(_0x2347f6[_0x446eff(0x212)]!==_0x446eff(0x15a))return-0x1;if(_0x2347f6[_0x446eff(0x214)][_0x446eff(0x130)](_0x446eff(0x162)))return 0x0;const _0x55213e=_0x2347f6[_0x446eff(0x214)][_0x446eff(0x139)](/(\d+)º/);return _0x55213e?parseInt(_0x55213e[0x1]):0x0;}function getSortPriority(_0x2b7cfb){const _0x1699bf=a0_0x59e94c;if(_0x2b7cfb[_0x1699bf(0x21f)][_0x1699bf(0x130)](_0x1699bf(0x105)))return 0x1;if(_0x2b7cfb[_0x1699bf(0x21f)]['includes']('Traços\x20Principais'))return 0x2;const _0x280780=_0x2b7cfb[_0x1699bf(0x214)]?_0x2b7cfb['meta'][_0x1699bf(0x139)](/Nível (\d+)/):null;if(_0x280780)return 0xa+parseInt(_0x280780[0x1]);if(_0x2b7cfb[_0x1699bf(0x214)]&&_0x2b7cfb[_0x1699bf(0x214)][_0x1699bf(0x130)](_0x1699bf(0x1ef)))return 0x64;return 0x32;}function renderRules(_0x3baf57){const _0x430bc5=a0_0x59e94c,_0x14efd7=document[_0x430bc5(0xd7)](_0x430bc5(0x136));if(!_0x14efd7)return;_0x14efd7[_0x430bc5(0x133)]='';if(_0x3baf57[_0x430bc5(0xe0)]===0x0){_0x14efd7[_0x430bc5(0x133)]='<div\x20style=\x27text-align:center;\x20color:#5d4037;\x20margin-top:20px;\x27>Nenhum\x20conhecimento\x20encontrado...</div>';return;}const _0xe43f53=[..._0x3baf57][_0x430bc5(0x207)]((_0x91e92e,_0x4b4926)=>{const _0x138576=_0x430bc5,_0x4ed44e={'basics':0x0,'condition':0x1,'action':0x2,'combat':0x3,'env':0x4,'class':0x5,'species':0x6,'feat':0x7,'spell':0x8,'equipment':0x9},_0x365127=_0x4ed44e[_0x91e92e[_0x138576(0x212)]]!==undefined?_0x4ed44e[_0x91e92e[_0x138576(0x212)]]:0x63,_0x288435=_0x4ed44e[_0x4b4926['category']]!==undefined?_0x4ed44e[_0x4b4926[_0x138576(0x212)]]:0x63;if(_0x365127!==_0x288435)return _0x365127-_0x288435;if([_0x138576(0x14b),_0x138576(0x102),_0x138576(0x21a),_0x138576(0x1dc),_0x138576(0xcb)]['includes'](_0x91e92e[_0x138576(0x212)])){if(_0x91e92e[_0x138576(0x1be)]!==_0x4b4926[_0x138576(0x1be)])return _0x91e92e[_0x138576(0x1be)][_0x138576(0x1ed)](_0x4b4926['parentClass']);const _0x483115=typeof getSortPriority==='function'?getSortPriority(_0x91e92e):0x32,_0x2a6b1b=typeof getSortPriority==='function'?getSortPriority(_0x4b4926):0x32;if(_0x483115!==_0x2a6b1b)return _0x483115-_0x2a6b1b;}const _0x92b1db=typeof getLevelValue===_0x138576(0x10d)?getLevelValue(_0x91e92e):0x0,_0x560e61=typeof getLevelValue===_0x138576(0x10d)?getLevelValue(_0x4b4926):0x0;if(_0x92b1db!==_0x560e61)return _0x92b1db-_0x560e61;return _0x91e92e[_0x138576(0x21f)]['localeCompare'](_0x4b4926['title']);});let _0x50a18e='';_0xe43f53[_0x430bc5(0x220)](_0x423dfd=>{const _0xca7398=_0x430bc5;let _0x1de446='',_0x38f97a='';if(_0x423dfd[_0xca7398(0x212)]===_0xca7398(0x15a)){const _0x535fee=getLevelValue(_0x423dfd);_0x1de446=_0x535fee===0x0?_0xca7398(0x15f):_0xca7398(0x1d7)+_0x535fee+'º',_0x38f97a='lvl-'+_0x535fee;}else{if(['basics',_0xca7398(0x102),_0xca7398(0x21a),'equipment',_0xca7398(0xcb)]['includes'](_0x423dfd['category'])){_0x1de446=_0x423dfd[_0xca7398(0x1be)];const _0xb79f4c=_0x1de446['toLowerCase']()[_0xca7398(0x1a0)](_0xca7398(0x129))['replace'](/[\u0300-\u036f]/g,'')[_0xca7398(0xa9)](/\s+/g,'');_0x38f97a=_0xca7398(0x1f2)+_0xb79f4c;}else _0x1de446=null;}if(_0x1de446&&_0x50a18e!==_0x1de446){_0x50a18e=_0x1de446;const _0x269413=document[_0xca7398(0xea)]('div');_0x269413[_0xca7398(0xab)]='level-header\x20'+_0x38f97a,_0x269413['innerText']=_0x1de446,_0x14efd7['appendChild'](_0x269413);}const _0x46b242=document[_0xca7398(0xea)](_0xca7398(0x1b4));_0x46b242[_0xca7398(0xab)]=_0xca7398(0x1c3);let _0x4d4e23=translateCategory(_0x423dfd[_0xca7398(0x212)]),_0x427b8e='';if([_0xca7398(0x102),_0xca7398(0x21a),'equipment',_0xca7398(0xcb)]['includes'](_0x423dfd['category'])){_0x4d4e23=_0x423dfd['parentClass'];const _0x37f7ab=_0x4d4e23['toLowerCase']()['normalize'](_0xca7398(0x129))[_0xca7398(0xa9)](/[\u0300-\u036f]/g,'')[_0xca7398(0xa9)](/\s+/g,'');_0x427b8e=_0xca7398(0x12d)+_0x37f7ab;}else _0x427b8e='tag-'+_0x423dfd[_0xca7398(0x212)];let _0x43de84=_0x423dfd[_0xca7398(0x214)]?_0xca7398(0xf7)+_0x423dfd[_0xca7398(0x214)]+_0xca7398(0x1cc):'';_0x46b242[_0xca7398(0x133)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22rule-title\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+_0x423dfd[_0xca7398(0x21f)]+_0xca7398(0x1ad)+_0x427b8e+_0xca7398(0x117)+(_0x423dfd['category']==='spell'?'#7b1fa2':'')+'\x22>'+_0x4d4e23+_0xca7398(0xbe)+_0x43de84+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22rule-desc\x22>'+_0x423dfd['text']+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20',_0x14efd7[_0xca7398(0x1e8)](_0x46b242);});}function translateCategory(_0x1c2a64){const _0x4038a1=a0_0x59e94c;if(_0x1c2a64===_0x4038a1(0x14b))return _0x4038a1(0x11e);if(_0x1c2a64==='condition')return _0x4038a1(0x149);if(_0x1c2a64===_0x4038a1(0x1e0))return _0x4038a1(0x183);if(_0x1c2a64===_0x4038a1(0x22b))return _0x4038a1(0x12a);if(_0x1c2a64==='spell')return'Magia';if(_0x1c2a64==='env')return _0x4038a1(0x10a);if(_0x1c2a64==='species')return _0x4038a1(0x104);if(_0x1c2a64===_0x4038a1(0x1dc))return _0x4038a1(0x1c9);if(_0x1c2a64==='feat')return _0x4038a1(0x1e5);return _0x1c2a64;}function filterRules(){const _0xeb95ec=a0_0x59e94c,_0x118847=document[_0xeb95ec(0xd7)](_0xeb95ec(0x1b1));if(!_0x118847||typeof rulesData===_0xeb95ec(0x12c))return;const _0x3932e7=normalizeText(_0x118847[_0xeb95ec(0x1b6)]['trim']());let _0x5c1e79=_0x3932e7;_0x3932e7['length']>0x3&&(_0x5c1e79=_0x3932e7['replace'](/(r|s)$/,''));const _0x48773d=rulesData[_0xeb95ec(0x1fc)](_0x479842=>{const _0x164e8b=_0xeb95ec,_0x412485=normalizeText(_0x479842[_0x164e8b(0x21f)]),_0x269bbd=normalizeText(_0x479842['text']),_0x35b8fb=normalizeText(_0x479842[_0x164e8b(0x214)]||''),_0x12cd2f=_0x412485[_0x164e8b(0x130)](_0x3932e7)||_0x412485[_0x164e8b(0x130)](_0x5c1e79),_0x506226=_0x269bbd['includes'](_0x3932e7)||_0x269bbd[_0x164e8b(0x130)](_0x5c1e79),_0x598dbd=_0x35b8fb[_0x164e8b(0x130)](_0x3932e7)||_0x35b8fb[_0x164e8b(0x130)](_0x5c1e79);return _0x12cd2f||_0x506226||_0x598dbd;});renderRules(_0x48773d),document['querySelectorAll'](_0xeb95ec(0xd6))[_0xeb95ec(0x220)](_0x42a2aa=>_0x42a2aa[_0xeb95ec(0x201)]['remove']('active'));}function normalizeText(_0x1bb7b4){const _0x37cafd=a0_0x59e94c;if(!_0x1bb7b4)return'';return _0x1bb7b4['normalize'](_0x37cafd(0x129))[_0x37cafd(0xa9)](/[\u0300-\u036f]/g,'')[_0x37cafd(0x21b)]();}function filterCategory(_0x2df7d6){const _0x5c72bf=a0_0x59e94c;document[_0x5c72bf(0x14e)](_0x5c72bf(0xd6))[_0x5c72bf(0x220)](_0x3a611d=>_0x3a611d['classList'][_0x5c72bf(0x1ea)]('active'));if(event&&event['target'])event[_0x5c72bf(0x1c8)][_0x5c72bf(0x201)]['add']('active');const _0x3cf171=document[_0x5c72bf(0xd7)](_0x5c72bf(0x1b1));if(_0x3cf171)_0x3cf171[_0x5c72bf(0x1b6)]='';if(typeof rulesData==='undefined')return;if(_0x2df7d6===_0x5c72bf(0x16e))renderRules(rulesData);else{const _0x33fdbb=rulesData[_0x5c72bf(0x1fc)](_0x257d30=>_0x257d30[_0x5c72bf(0x212)]===_0x2df7d6);renderRules(_0x33fdbb);}}function setupEventListeners(){const _0x45ae94=a0_0x59e94c,_0x47f7b5=document[_0x45ae94(0xd7)](_0x45ae94(0x115));if(_0x47f7b5)_0x47f7b5[_0x45ae94(0x194)]=addCharacterPreview;const _0x20c94f=document[_0x45ae94(0xd7)](_0x45ae94(0xf2));if(_0x20c94f)_0x20c94f[_0x45ae94(0x194)]=startCampaign;const _0x201d52=document[_0x45ae94(0xd7)](_0x45ae94(0xf4));_0x201d52&&(_0x201d52['addEventListener'](_0x45ae94(0x16b),startCharging),window[_0x45ae94(0x101)](_0x45ae94(0x11f),releaseRoll),_0x201d52[_0x45ae94(0x101)](_0x45ae94(0x218),_0x281394=>{const _0x36ab86=_0x45ae94;_0x281394[_0x36ab86(0x1f0)](),startCharging();}),window['addEventListener']('touchend',releaseRoll));const _0x9df45f=document[_0x45ae94(0xd7)](_0x45ae94(0x1a2));if(_0x9df45f)_0x9df45f['onclick']=clearDice;const _0x4884ab=document['getElementById']('toggleHistoryBtn');if(_0x4884ab)_0x4884ab['onclick']=toggleHistory;window[_0x45ae94(0x101)](_0x45ae94(0xe7),refreshCanvasSize);}document[a0_0x59e94c(0x101)]('DOMContentLoaded',()=>{setupEventListeners();});function openDonation(){const _0x156cdf=a0_0x59e94c,_0x300c92='https://apoia.se/rollenapp';playSound(_0x156cdf(0x170)),window[_0x156cdf(0x13c)](_0x300c92,_0x156cdf(0x159));}document['addEventListener'](a0_0x59e94c(0x14d),_0x3089bd=>_0x3089bd[a0_0x59e94c(0x1f0)]()),document[a0_0x59e94c(0x1b9)]=function(_0x3b9f48){const _0x34bedb=a0_0x59e94c;if(_0x3b9f48['keyCode']==0x7b)return![];if(_0x3b9f48['ctrlKey']&&_0x3b9f48[_0x34bedb(0xe6)]&&(_0x3b9f48[_0x34bedb(0x1ab)]=='I'[_0x34bedb(0x16a)](0x0)||_0x3b9f48['keyCode']=='C'[_0x34bedb(0x16a)](0x0)||_0x3b9f48[_0x34bedb(0x1ab)]=='J'['charCodeAt'](0x0)))return![];if(_0x3b9f48[_0x34bedb(0x121)]&&_0x3b9f48[_0x34bedb(0x1ab)]=='U'[_0x34bedb(0x16a)](0x0))return![];};function hideSplashScreen(){const _0x550b09=a0_0x59e94c,_0x5c28ee=document[_0x550b09(0xd7)]('splash-screen');_0x5c28ee&&(console[_0x550b09(0x204)](_0x550b09(0x185)),_0x5c28ee[_0x550b09(0x201)][_0x550b09(0xf8)](_0x550b09(0xd2)),setTimeout(()=>{const _0x3ad29c=_0x550b09;_0x5c28ee[_0x3ad29c(0x1a5)][_0x3ad29c(0xbf)]='none';},0x320));}window[a0_0x59e94c(0x101)](a0_0x59e94c(0x137),hideSplashScreen),setTimeout(()=>{const _0x36096d=a0_0x59e94c,_0x583c64=document[_0x36096d(0xd7)]('splash-screen');_0x583c64&&!_0x583c64[_0x36096d(0x201)][_0x36096d(0x141)]('splash-hidden')&&(console['warn'](_0x36096d(0x151)),hideSplashScreen());},0x1388);