const a0_0x3dd0a7=a0_0x1d86;(function(_0x22075b,_0x4af35c){const _0x3298d2=a0_0x1d86,_0xc51035=_0x22075b();while(!![]){try{const _0x18c8d9=parseInt(_0x3298d2(0x257))/0x1*(parseInt(_0x3298d2(0x24a))/0x2)+parseInt(_0x3298d2(0x155))/0x3+parseInt(_0x3298d2(0x107))/0x4+parseInt(_0x3298d2(0xed))/0x5*(parseInt(_0x3298d2(0x1b1))/0x6)+parseInt(_0x3298d2(0x16f))/0x7*(parseInt(_0x3298d2(0x174))/0x8)+-parseInt(_0x3298d2(0x1e9))/0x9+-parseInt(_0x3298d2(0x25f))/0xa;if(_0x18c8d9===_0x4af35c)break;else _0xc51035['push'](_0xc51035['shift']());}catch(_0xbb9013){_0xc51035['push'](_0xc51035['shift']());}}}(a0_0x183b,0x3affe));const AudioContext=window[a0_0x3dd0a7(0x141)]||window[a0_0x3dd0a7(0x241)],audioCtx=new AudioContext(),soundBuffers={};let currentHoldSource=null;const soundMap={'click':a0_0x3dd0a7(0x254),'touch':a0_0x3dd0a7(0x206),'hold':a0_0x3dd0a7(0x1d2),'shoot':'./shoot.mp3','start':a0_0x3dd0a7(0x1a0),'crit':a0_0x3dd0a7(0x230),'fumble':a0_0x3dd0a7(0x218),'col0':'./collide1.mp3','col1':'./collide2.mp3','col2':a0_0x3dd0a7(0x119),'col3':'./collide4.mp3','col4':a0_0x3dd0a7(0x26e)};async function preloadSounds(){const _0x1db1a8=a0_0x3dd0a7;for(const [_0x4bf453,_0x23c93e]of Object[_0x1db1a8(0x185)](soundMap)){try{const _0x4e403c=await fetch(_0x23c93e),_0xe0daef=await _0x4e403c['arrayBuffer'](),_0x2f2ead=await audioCtx[_0x1db1a8(0x120)](_0xe0daef);soundBuffers[_0x4bf453]=_0x2f2ead;}catch(_0x43b5a1){console[_0x1db1a8(0x237)](_0x1db1a8(0x1bb)+_0x4bf453,_0x43b5a1);}}}preloadSounds();function playSound(_0x37a719,_0xe8fbda=null){const _0x12a0c4=a0_0x3dd0a7;if(audioCtx[_0x12a0c4(0x1e8)]===_0x12a0c4(0x104))audioCtx[_0x12a0c4(0x1fe)]()[_0x12a0c4(0x18b)](()=>{});let _0x5cc9b0=_0x37a719;if(_0x37a719===_0x12a0c4(0x1fc)&&_0xe8fbda!==null)_0x5cc9b0=_0x12a0c4(0x1d0)+_0xe8fbda;const _0x455c8d=soundBuffers[_0x5cc9b0];if(!_0x455c8d)return;const _0x186884=audioCtx[_0x12a0c4(0xf6)](),_0x464c92=audioCtx['createGain']();_0x186884[_0x12a0c4(0x156)]=_0x455c8d;if(_0x37a719==='roll')_0x464c92['gain'][_0x12a0c4(0xe9)]=0x1;else{if(_0x37a719==='shoot')_0x464c92['gain']['value']=0.3;else{if(_0x37a719==='touch'||_0x37a719===_0x12a0c4(0xec))_0x464c92[_0x12a0c4(0x1f7)]['value']=0.4;else{if(_0x37a719===_0x12a0c4(0x1fc))_0x464c92[_0x12a0c4(0x1f7)]['value']=0.8;else _0x464c92['gain'][_0x12a0c4(0xe9)]=0x1;}}}_0x186884[_0x12a0c4(0x167)][_0x12a0c4(0xe9)]=0.95+Math[_0x12a0c4(0x131)]()*0.1,_0x186884['connect'](_0x464c92),_0x464c92[_0x12a0c4(0x24e)](audioCtx[_0x12a0c4(0x1ca)]);if(_0x37a719===_0x12a0c4(0x23c)){if(currentHoldSource)try{currentHoldSource['stop']();}catch(_0x1532d4){}_0x186884[_0x12a0c4(0x183)]=!![],currentHoldSource=_0x186884;}_0x186884[_0x12a0c4(0x1fd)](0x0);}function stopHoldSound(){const _0x5733bf=a0_0x3dd0a7;if(currentHoldSource)try{currentHoldSource[_0x5733bf(0x126)](),currentHoldSource=null;}catch(_0x1eaea7){}}const avatars={'master':a0_0x3dd0a7(0x1b3),'monster':a0_0x3dd0a7(0x121),'boss':a0_0x3dd0a7(0x11f),'familiar':a0_0x3dd0a7(0x106),'humanf':a0_0x3dd0a7(0x1fa),'humanm':a0_0x3dd0a7(0x19b),'bhumanm':a0_0x3dd0a7(0x171),'bhumanf':a0_0x3dd0a7(0x17c),'dragonbornf':a0_0x3dd0a7(0x170),'dragonbornm':a0_0x3dd0a7(0x1e7),'elfdrowf':a0_0x3dd0a7(0x19a),'elfdrowm':a0_0x3dd0a7(0x12a),'elfhighf':'<img\x20src=\x22elfhighf.png\x22\x20class=\x22avatar-img\x22\x20alt=\x22High\x20Elfa\x22>','elfhighm':a0_0x3dd0a7(0x154),'elfwoodf':a0_0x3dd0a7(0x191),'elfwoodm':a0_0x3dd0a7(0x123),'gnomef':a0_0x3dd0a7(0x223),'gnomem':a0_0x3dd0a7(0x1a5),'tieflingf':a0_0x3dd0a7(0x173),'tieflingm':'<img\x20src=\x22tieflingm.png\x22\x20class=\x22avatar-img\x22\x20alt=\x22Tiefling\x20M\x22>','halfelff':'<img\x20src=\x22halfelff.png\x22\x20class=\x22avatar-img\x22\x20alt=\x22Meia\x20Elfa\x22>','halfelfm':a0_0x3dd0a7(0xf1),'halforcf':a0_0x3dd0a7(0x26b),'halforcm':a0_0x3dd0a7(0x163),'aesimarm':a0_0x3dd0a7(0x13e),'aesimarf':a0_0x3dd0a7(0x21c),'goliathm':'<img\x20src=\x22goliathm.png\x22\x20class=\x22avatar-img\x22\x20alt=\x22Goliath\x20M\x22>','goliathf':a0_0x3dd0a7(0x18f)},diceConfigs={0x4:{'color':0xef5350},0x6:{'color':0xffca28},0x8:{'color':0x66bb6a},0xa:{'color':0x42a5f5},0xc:{'color':0xab47bc},0x14:{'color':0xffffff}},diceTypes=[0x4,0x6,0x8,0xa,0xc,0x14];let campaign={'name':'Aventura','characters':[],'globalLog':[]},activeCharIndex=0x0,selectedAvatarKey=a0_0x3dd0a7(0x274),diceObjects=[],magicEffects=[],hasCritHappened=![],currentSpecialSound=null,world,scene,camera,renderer,isRolling=![],pressTimer=null,pressPower=0x0,isPressing=![],sparkleTexture=null,walls={'left':null,'right':null,'top':null,'bottom':null},isGameRunning=![],clock=new THREE['Clock'](),rollMode='normal',lastCollisionTime=0x0,matDice,matGround;document[a0_0x3dd0a7(0x226)](a0_0x3dd0a7(0x202),()=>{const _0x530449=a0_0x3dd0a7;try{loadData();}catch(_0x1c2ae9){console[_0x530449(0x1db)](_0x530449(0x1eb),_0x1c2ae9),localStorage[_0x530449(0x113)]();}renderDiceButtons(),renderAvatarSelection(),setupEventListeners(),setupColorPicker(),setupModPicker();try{initPhysicsAndGraphics(),animate();}catch(_0x5879b4){console[_0x530449(0x1db)](_0x530449(0x18e),_0x5879b4);}});function saveData(){const _0x4f99aa=a0_0x3dd0a7;try{const _0x12f1d6=document[_0x4f99aa(0x22f)](_0x4f99aa(0x13a));_0x12f1d6&&campaign[_0x4f99aa(0x1a7)][activeCharIndex]&&(campaign[_0x4f99aa(0x1a7)][activeCharIndex][_0x4f99aa(0x14c)]=parseInt(_0x12f1d6[_0x4f99aa(0xe9)])||0x0);const _0xe03246={'campaign':campaign,'activeCharIndex':activeCharIndex,'isGameRunning':isGameRunning};localStorage[_0x4f99aa(0x162)]('rollen_save_v1',JSON[_0x4f99aa(0x161)](_0xe03246));}catch(_0x328cc4){console[_0x4f99aa(0x1db)](_0x4f99aa(0x137),_0x328cc4);}}function loadData(){const _0x40228c=a0_0x3dd0a7,_0x70789f=localStorage[_0x40228c(0x18a)]('rollen_save_v1');if(_0x70789f)try{const _0x309a0c=JSON[_0x40228c(0x169)](_0x70789f);if(_0x309a0c[_0x40228c(0x1a4)]){campaign=_0x309a0c[_0x40228c(0x1a4)];if(!Array['isArray'](campaign[_0x40228c(0x1a7)]))campaign[_0x40228c(0x1a7)]=[];if(!Array[_0x40228c(0x227)](campaign[_0x40228c(0x203)]))campaign[_0x40228c(0x203)]=[];activeCharIndex=_0x309a0c[_0x40228c(0x14a)]||0x0,isGameRunning=_0x309a0c['isGameRunning']||![];if(isGameRunning&&campaign[_0x40228c(0x1a7)][_0x40228c(0x1c4)]>0x0){document['getElementById'](_0x40228c(0x195))['style'][_0x40228c(0xfe)]=_0x40228c(0x273),document['getElementById'](_0x40228c(0x10f))[_0x40228c(0x264)][_0x40228c(0xfe)]=_0x40228c(0x22a),setTimeout(()=>refreshCanvasSize(),0x32),renderTabs();const _0x23ba5=activeCharIndex;activeCharIndex=-0x1,setTimeout(()=>switchTab(_0x23ba5),0x64);}else document[_0x40228c(0x22f)](_0x40228c(0x195))[_0x40228c(0x264)][_0x40228c(0xfe)]=_0x40228c(0x22a),updateModalCharList();}}catch(_0x2179a0){console[_0x40228c(0x1db)](_0x40228c(0x142),_0x2179a0);}}function updateModalCharList(){const _0x208640=a0_0x3dd0a7,_0x2efa0e=document[_0x208640(0x22f)](_0x208640(0x23a));if(!_0x2efa0e)return;_0x2efa0e[_0x208640(0x17b)]='';if(!campaign[_0x208640(0x1a7)])campaign[_0x208640(0x1a7)]=[];campaign[_0x208640(0x1a7)][_0x208640(0x15c)](_0x44079c=>{const _0x2be8d3=_0x208640,_0x385746=document[_0x2be8d3(0x180)]('li');_0x385746['innerHTML']=_0x2be8d3(0x21e)+_0x44079c[_0x2be8d3(0x139)]+'\x22>'+_0x44079c[_0x2be8d3(0x14d)]+_0x2be8d3(0x12e)+_0x44079c[_0x2be8d3(0x139)]+_0x2be8d3(0x1c9)+_0x44079c[_0x2be8d3(0x194)]+_0x2be8d3(0x112),_0x2efa0e[_0x2be8d3(0x103)](_0x385746);});const _0x78e3fe=document[_0x208640(0x22f)]('startCampaignBtn');if(_0x78e3fe)_0x78e3fe['disabled']=campaign[_0x208640(0x1a7)]['length']===0x0;}function renderDiceButtons(){const _0x12b520=a0_0x3dd0a7,_0x27c0c6=document['getElementById']('diceSelector');if(!_0x27c0c6)return;_0x27c0c6['innerHTML']='',diceTypes[_0x12b520(0x15c)](_0x2be10b=>{const _0x660c94=_0x12b520,_0x377f58=document[_0x660c94(0x180)](_0x660c94(0x12f));_0x377f58[_0x660c94(0x128)]=_0x660c94(0x1fb),_0x377f58['id']=_0x660c94(0x21a)+_0x2be10b,_0x377f58[_0x660c94(0x17b)]='D'+_0x2be10b+_0x660c94(0x27f)+_0x2be10b+_0x660c94(0x1cb),_0x377f58[_0x660c94(0xfa)]=()=>addDice(_0x2be10b),_0x27c0c6['appendChild'](_0x377f58);});}function renderAvatarSelection(){const _0x48204b=a0_0x3dd0a7,_0x68a5d0=document[_0x48204b(0x22f)]('avatarGrid');if(!_0x68a5d0)return;_0x68a5d0[_0x48204b(0x17b)]='',Object['keys'](avatars)[_0x48204b(0x15c)](_0x3bb2bf=>{const _0xc603da=_0x48204b,_0x1366b2=document[_0xc603da(0x180)](_0xc603da(0xf3));_0x1366b2[_0xc603da(0x128)]=_0xc603da(0x12b)+(_0x3bb2bf===selectedAvatarKey?_0xc603da(0x133):''),_0x1366b2[_0xc603da(0x17b)]=avatars[_0x3bb2bf],_0x1366b2['onclick']=()=>{const _0x453638=_0xc603da;document['querySelectorAll']('.avatar-option')[_0x453638(0x15c)](_0xe9e8ae=>_0xe9e8ae[_0x453638(0x10e)]['remove']('selected')),_0x1366b2[_0x453638(0x10e)][_0x453638(0x213)](_0x453638(0x133)),selectedAvatarKey=_0x3bb2bf;},_0x68a5d0[_0xc603da(0x103)](_0x1366b2);});}function setupColorPicker(){const _0x46bc7f=a0_0x3dd0a7,_0x3ac881=document['getElementById'](_0x46bc7f(0x199)),_0x21c6c0=document[_0x46bc7f(0x1ab)]('.color-picker-wrapper');if(_0x3ac881&&_0x21c6c0){const _0x454e60=()=>{const _0x35c6a5=_0x46bc7f;_0x21c6c0[_0x35c6a5(0x264)]['backgroundColor']=_0x3ac881[_0x35c6a5(0xe9)];};_0x3ac881['addEventListener'](_0x46bc7f(0x228),_0x454e60),_0x454e60();}}function updateDiceButtonUI(_0x1e5f2b,_0x317dfc,_0x346ba1){const _0x1aab5e=a0_0x3dd0a7,_0x5be057=document['getElementById']('count-d'+_0x1e5f2b),_0x393dc9=document[_0x1aab5e(0x22f)]('btn-d'+_0x1e5f2b);if(!_0x5be057||!_0x393dc9)return;if(_0x346ba1){_0x5be057[_0x1aab5e(0x17a)]='0',_0x5be057[_0x1aab5e(0x264)][_0x1aab5e(0xfe)]=_0x1aab5e(0x273),_0x393dc9[_0x1aab5e(0x10e)][_0x1aab5e(0x15f)](_0x1aab5e(0x133));return;}let _0x370cb7=parseInt(_0x5be057['innerText'])||0x0;_0x370cb7+=_0x317dfc,_0x5be057[_0x1aab5e(0x17a)]=_0x370cb7,_0x5be057['style']['display']=_0x370cb7>0x0?_0x1aab5e(0x22a):'none';if(_0x370cb7>0x0)_0x393dc9['classList']['add'](_0x1aab5e(0x133));}function updateResultDisplay(_0x121217,_0x514fb3){const _0x1e56a1=a0_0x3dd0a7,_0xb2311c=document[_0x1e56a1(0x22f)](_0x1e56a1(0x27b)),_0x2170aa=document[_0x1e56a1(0x22f)](_0x1e56a1(0x11d));if(_0xb2311c)_0xb2311c[_0x1e56a1(0x17b)]=_0x121217;if(_0x2170aa){_0x2170aa[_0x1e56a1(0x17a)]=_0x514fb3;const _0x511072=campaign[_0x1e56a1(0x1a7)][activeCharIndex];if(_0x511072)_0x2170aa['style'][_0x1e56a1(0x139)]=_0x1e56a1(0x277);}}function openAddCharModal(){const _0x13f553=a0_0x3dd0a7,_0x4ab344=document[_0x13f553(0x22f)](_0x13f553(0x195)),_0x29a8c9=document[_0x13f553(0x22f)](_0x13f553(0x25a));updateModalCharList(),isGameRunning?(_0x29a8c9[_0x13f553(0x17a)]=_0x13f553(0x23e),_0x29a8c9['disabled']=![]):(_0x29a8c9[_0x13f553(0x17a)]=_0x13f553(0x140),_0x29a8c9[_0x13f553(0x110)]=campaign[_0x13f553(0x1a7)]['length']===0x0),_0x4ab344[_0x13f553(0x264)][_0x13f553(0xfe)]=_0x13f553(0x22a),playSound(_0x13f553(0xec));}function addCharacterPreview(){const _0x7973a5=a0_0x3dd0a7;try{const _0xebe4a=document[_0x7973a5(0x22f)](_0x7973a5(0x127)),_0x192743=document['getElementById']('charColorInput');if(!_0xebe4a||!_0x192743)return;const _0x37240c=_0xebe4a[_0x7973a5(0xe9)][_0x7973a5(0x193)](),_0x271b31=_0x192743['value'];if(!_0x37240c)return;const _0x59f13a={'name':_0x37240c,'color':_0x271b31,'avatar':avatars[selectedAvatarKey]||avatars[_0x7973a5(0x274)],'turnCount':0x1,'history':[],'modifier':0x0,'rollMode':_0x7973a5(0x1ff)};if(!campaign[_0x7973a5(0x1a7)])campaign[_0x7973a5(0x1a7)]=[];campaign['characters'][_0x7973a5(0x1ba)](_0x59f13a),saveData(),updateModalCharList(),_0xebe4a['value']='',selectedAvatarKey=_0x7973a5(0x274),renderAvatarSelection(),playSound(_0x7973a5(0xec));}catch(_0x137147){console['error'](_0x7973a5(0x12d),_0x137147),alert(_0x7973a5(0x1c8));}}function startCampaign(){const _0x56109d=a0_0x3dd0a7;campaign[_0x56109d(0x194)]=document['getElementById'](_0x56109d(0x1a3))[_0x56109d(0xe9)]||_0x56109d(0x268),isGameRunning=!![],saveData(),document[_0x56109d(0x22f)]('setupModal')[_0x56109d(0x264)][_0x56109d(0xfe)]=_0x56109d(0x273),document[_0x56109d(0x22f)](_0x56109d(0x10f))[_0x56109d(0x264)]['display']=_0x56109d(0x22a),setTimeout(()=>refreshCanvasSize(),0x32),renderTabs(),activeCharIndex=-0x1,setTimeout(()=>{const _0x193fa2=_0x56109d;if(campaign['characters'][_0x193fa2(0x1c4)]>0x0)switchTab(0x0);},0x64);}function renderTabs(){const _0x4c4dc5=a0_0x3dd0a7,_0x2691c9=document[_0x4c4dc5(0x22f)](_0x4c4dc5(0x25c));if(!_0x2691c9)return;_0x2691c9[_0x4c4dc5(0x17b)]='';if(!campaign['characters'])campaign['characters']=[];campaign[_0x4c4dc5(0x1a7)][_0x4c4dc5(0x15c)]((_0x42bb11,_0x2b2644)=>{const _0x51ddce=_0x4c4dc5,_0x313ec7=document[_0x51ddce(0x180)]('div');_0x313ec7['className']='char-tab\x20'+(_0x2b2644===activeCharIndex?_0x51ddce(0x214):''),_0x313ec7['innerHTML']=_0x51ddce(0x1de)+_0x42bb11[_0x51ddce(0x14d)]+'</div>\x20'+_0x42bb11[_0x51ddce(0x194)],_0x313ec7[_0x51ddce(0x264)][_0x51ddce(0x21b)]=_0x42bb11[_0x51ddce(0x139)];if(_0x2b2644===activeCharIndex){_0x313ec7[_0x51ddce(0x264)][_0x51ddce(0x139)]=_0x42bb11['color'];const _0x257a28=_0x313ec7[_0x51ddce(0x1ab)](_0x51ddce(0x158));if(_0x257a28)_0x257a28['style']['fill']=_0x42bb11[_0x51ddce(0x139)];}_0x313ec7['onclick']=()=>switchTab(_0x2b2644),_0x313ec7[_0x51ddce(0x22e)]=!![],_0x313ec7[_0x51ddce(0x1b0)]=_0x5016c8=>{const _0x30ac29=_0x51ddce;_0x5016c8[_0x30ac29(0x11e)][_0x30ac29(0x17f)](_0x30ac29(0x259),_0x2b2644),_0x313ec7['style'][_0x30ac29(0x1e1)]=_0x30ac29(0x117);},_0x313ec7['ondragend']=()=>{const _0x49d0ae=_0x51ddce;_0x313ec7[_0x49d0ae(0x264)]['opacity']='1';},_0x313ec7[_0x51ddce(0x19c)]=_0x2b543a=>{const _0x5d54cd=_0x51ddce;_0x2b543a[_0x5d54cd(0x1f1)]();},_0x313ec7[_0x51ddce(0x1ee)]=_0x32a582=>{const _0x510cd6=_0x51ddce;_0x32a582[_0x510cd6(0x1f1)]();const _0x30f786=parseInt(_0x32a582[_0x510cd6(0x11e)][_0x510cd6(0x1e6)](_0x510cd6(0x259))),_0x1e2f45=_0x2b2644;if(_0x30f786!==_0x1e2f45){const _0x206f79=campaign['characters'][_0x510cd6(0x217)](_0x30f786,0x1)[0x0];campaign[_0x510cd6(0x1a7)][_0x510cd6(0x217)](_0x1e2f45,0x0,_0x206f79);if(activeCharIndex===_0x30f786)activeCharIndex=_0x1e2f45;else{if(activeCharIndex>_0x30f786&&activeCharIndex<=_0x1e2f45)activeCharIndex--;else{if(activeCharIndex<_0x30f786&&activeCharIndex>=_0x1e2f45)activeCharIndex++;}}saveData(),renderTabs();}},_0x2691c9['appendChild'](_0x313ec7);});const _0x58790b=document[_0x4c4dc5(0x180)](_0x4c4dc5(0x12f));_0x58790b[_0x4c4dc5(0x128)]='add-char-tab',_0x58790b[_0x4c4dc5(0x17a)]='+',_0x58790b[_0x4c4dc5(0xfa)]=openAddCharModal,_0x2691c9['appendChild'](_0x58790b);}function switchTab(_0x687ae3){const _0x18a949=a0_0x3dd0a7;if(_0x687ae3<0x0||_0x687ae3>=campaign[_0x18a949(0x1a7)][_0x18a949(0x1c4)])return;activeCharIndex=_0x687ae3;const _0x4c03aa=campaign[_0x18a949(0x1a7)][activeCharIndex];clearDice();const _0x34eea6=document[_0x18a949(0x22f)](_0x18a949(0x13a)),_0x443d5a=document[_0x18a949(0x22f)](_0x18a949(0x243));if(_0x34eea6)_0x34eea6[_0x18a949(0xe9)]=_0x4c03aa['modifier']||0x0;if(_0x443d5a)_0x443d5a[_0x18a949(0x17a)]=(_0x4c03aa[_0x18a949(0x14c)]>0x0?'+':'')+(_0x4c03aa[_0x18a949(0x14c)]||0x0);setRollMode(_0x4c03aa['rollMode']||_0x18a949(0x1ff));const _0x338618=document[_0x18a949(0x22f)](_0x18a949(0x201));if(_0x338618&&_0x4c03aa){_0x338618['innerHTML']=_0x4c03aa[_0x18a949(0x14d)],_0x338618[_0x18a949(0x264)][_0x18a949(0x21b)]=_0x4c03aa['color'];const _0x531aaf=_0x338618[_0x18a949(0x1ab)](_0x18a949(0x158));if(_0x531aaf)_0x531aaf[_0x18a949(0x264)]['fill']=_0x4c03aa[_0x18a949(0x139)];}const _0x2e77e4=document[_0x18a949(0x22f)](_0x18a949(0x11d));if(_0x2e77e4)_0x2e77e4[_0x18a949(0x264)]['color']=_0x4c03aa[_0x18a949(0x139)];renderTabs(),updateHistoryUI(),saveData();}function toggleSettings(){const _0x2fc898=a0_0x3dd0a7,_0x2fc6b8=document['getElementById'](_0x2fc898(0x1f8));_0x2fc6b8[_0x2fc898(0x264)][_0x2fc898(0xfe)]=_0x2fc6b8[_0x2fc898(0x264)][_0x2fc898(0xfe)]===_0x2fc898(0x273)?'flex':_0x2fc898(0x273),playSound(_0x2fc898(0xec));}function resetJourney(){const _0xe10b20=a0_0x3dd0a7;confirm('ATENÇÃO:\x20Isso\x20apagará\x20permanentemente\x20todos\x20os\x20seus\x20heróis\x20e\x20a\x20campanha\x20atual.\x20Deseja\x20continuar?')&&(localStorage[_0xe10b20(0x113)](),campaign={'name':_0xe10b20(0x268),'characters':[],'globalLog':[]},isGameRunning=![],location[_0xe10b20(0x143)]());}function resetCampaignHistory(){const _0x95694f=a0_0x3dd0a7;confirm('Zerar\x20histórico?')&&(campaign['characters']['forEach'](_0x390353=>{const _0x4f33cb=a0_0x1d86;_0x390353['history']=[],_0x390353[_0x4f33cb(0x20d)]=0x1;}),campaign['globalLog']=[],updateHistoryUI(),toggleSettings(),saveData(),alert(_0x95694f(0x132))),playSound(_0x95694f(0xec));}function initPhysicsAndGraphics(){const _0x394f46=a0_0x3dd0a7,_0x5e547b=document[_0x394f46(0x22f)](_0x394f46(0x190));if(!_0x5e547b)return;scene=new THREE[(_0x394f46(0x1b8))]();const _0x4e77c1=new THREE[(_0x394f46(0x1d7))](0xffffff,0.5);scene[_0x394f46(0x213)](_0x4e77c1);const _0x48b1a0=new THREE[(_0x394f46(0x16a))](0xffffff,0.8);_0x48b1a0[_0x394f46(0x10c)][_0x394f46(0x1bf)](0x5,0x14,0x5),_0x48b1a0[_0x394f46(0x1ea)]=!![],scene['add'](_0x48b1a0);const _0x389b07=new THREE[(_0x394f46(0x1e5))](0xaaccff,0.3);_0x389b07[_0x394f46(0x10c)][_0x394f46(0x1bf)](-0xa,0x5,-0xa),scene['add'](_0x389b07),camera=new THREE[(_0x394f46(0x13c))](0x2d,0x1,0.1,0x64),camera['position'][_0x394f46(0x1bf)](0x0,0x12,0x0),camera['lookAt'](0x0,0x0,0x0),renderer=new THREE['WebGLRenderer']({'alpha':!![],'antialias':!![]}),renderer[_0x394f46(0xe8)][_0x394f46(0x138)]=!![],renderer['shadowMap']['type']=THREE[_0x394f46(0x246)],_0x5e547b['appendChild'](renderer[_0x394f46(0x1da)]),sparkleTexture=createSparkleTexture(),world=new CANNON[(_0x394f46(0x17e))](),world[_0x394f46(0x13b)][_0x394f46(0x1bf)](0x0,-0x28,0x0),world['broadphase']=new CANNON[(_0x394f46(0x100))](),world[_0x394f46(0x168)][_0x394f46(0x1bc)]=0xa,matGround=new CANNON['Material'](),matDice=new CANNON['Material'](),world['addContactMaterial'](new CANNON[(_0x394f46(0x26c))](matGround,matDice,{'friction':0.2,'restitution':0.7})),world[_0x394f46(0x189)](new CANNON[(_0x394f46(0x26c))](matDice,matDice,{'friction':0.1,'restitution':0.7}));const _0x568550=new CANNON[(_0x394f46(0x239))]({'mass':0x0,'shape':new CANNON['Plane'](),'material':matGround});_0x568550['quaternion'][_0x394f46(0x188)](new CANNON[(_0x394f46(0x130))](0x1,0x0,0x0),-Math['PI']/0x2),world[_0x394f46(0x146)](_0x568550),walls['left']=createWallBody(),walls[_0x394f46(0x1ac)]=createWallBody(),walls[_0x394f46(0x261)]=createWallBody(),walls[_0x394f46(0x1b2)]=createWallBody();}function createWallBody(){const _0x37cad8=a0_0x3dd0a7,_0x5c4460=new CANNON[(_0x37cad8(0x239))]({'mass':0x0,'shape':new CANNON[(_0x37cad8(0x13d))](new CANNON['Vec3'](0x1,0xa,0x14))});return world[_0x37cad8(0x146)](_0x5c4460),_0x5c4460;}function updateWallPositions(){const _0x795531=a0_0x3dd0a7;if(!camera||!renderer)return;const _0x1884c4=camera[_0x795531(0x10c)]['y'],_0x30cb4d=THREE['Math'][_0x795531(0x1f0)](camera[_0x795531(0x1b7)]),_0x47c08b=0x2*Math[_0x795531(0x263)](_0x30cb4d/0x2)*_0x1884c4,_0x558d77=_0x47c08b*camera[_0x795531(0x152)],_0x446d31=0.9,_0x41b751=_0x558d77/0x2*_0x446d31,_0x1e5819=_0x47c08b/0x2*_0x446d31;walls[_0x795531(0x25d)]['position']['set'](-_0x41b751-0x1,0x0,0x0),walls[_0x795531(0x25d)]['shapes'][0x0]=new CANNON[(_0x795531(0x13d))](new CANNON[(_0x795531(0x130))](0x1,0xa,_0x1e5819*0x2)),walls[_0x795531(0x1ac)][_0x795531(0x10c)][_0x795531(0x1bf)](_0x41b751+0x1,0x0,0x0),walls[_0x795531(0x1ac)][_0x795531(0x116)][0x0]=new CANNON[(_0x795531(0x13d))](new CANNON['Vec3'](0x1,0xa,_0x1e5819*0x2)),walls[_0x795531(0x261)][_0x795531(0x10c)][_0x795531(0x1bf)](0x0,0x0,-_0x1e5819-0x1),walls[_0x795531(0x261)]['shapes'][0x0]=new CANNON['Box'](new CANNON[(_0x795531(0x130))](_0x41b751*0x2,0xa,0x1)),walls['bottom'][_0x795531(0x10c)]['set'](0x0,0x0,_0x1e5819+0x1),walls[_0x795531(0x1b2)][_0x795531(0x116)][0x0]=new CANNON[(_0x795531(0x13d))](new CANNON[(_0x795531(0x130))](_0x41b751*0x2,0xa,0x1));}function refreshCanvasSize(){const _0x1f7ea4=a0_0x3dd0a7,_0x4fd0c2=document['getElementById'](_0x1f7ea4(0x190));if(_0x4fd0c2&&camera&&renderer){const _0x20c979=_0x4fd0c2[_0x1f7ea4(0x135)],_0x57d580=_0x4fd0c2['clientHeight'];renderer[_0x1f7ea4(0x20c)](_0x20c979,_0x57d580),renderer[_0x1f7ea4(0x272)](Math[_0x1f7ea4(0x1d9)](window[_0x1f7ea4(0x242)],1.5)),camera['aspect']=_0x20c979/_0x57d580,camera[_0x1f7ea4(0x204)]();if(typeof updateWallPositions===_0x1f7ea4(0x276))updateWallPositions();}}function createDiceGeometry(_0xfa801b,_0x554607){const _0x593461=a0_0x3dd0a7,_0x3ccd79=_0x554607;let _0x1bb5d3,_0x457d5d,_0x2c8876=0.5;switch(_0xfa801b){case 0x4:_0x1bb5d3=new THREE[(_0x593461(0x11b))](_0x3ccd79),_0x457d5d=new CANNON['Box'](new CANNON[(_0x593461(0x130))](_0x3ccd79*0.5,_0x3ccd79*0.5,_0x3ccd79*0.5));break;case 0x6:_0x1bb5d3=new THREE[(_0x593461(0x1c2))](_0x3ccd79,_0x3ccd79,_0x3ccd79),_0x457d5d=new CANNON[(_0x593461(0x13d))](new CANNON[(_0x593461(0x130))](_0x3ccd79/0x2,_0x3ccd79/0x2,_0x3ccd79/0x2));break;case 0x8:_0x1bb5d3=new THREE[(_0x593461(0x207))](_0x3ccd79),_0x457d5d=new CANNON[(_0x593461(0x13d))](new CANNON['Vec3'](_0x3ccd79*0.5,_0x3ccd79*0.5,_0x3ccd79*0.5));break;case 0xa:_0x1bb5d3=new THREE['DodecahedronGeometry'](_0x3ccd79),_0x1bb5d3['scale'](0.8,1.2,0.8),_0x457d5d=new CANNON['Box'](new CANNON['Vec3'](_0x3ccd79*0.4,_0x3ccd79*0.6,_0x3ccd79*0.4));break;case 0xc:_0x1bb5d3=new THREE[(_0x593461(0x1d4))](_0x3ccd79),_0x457d5d=new CANNON['Sphere'](_0x3ccd79*0.9),_0x2c8876=0.8;break;case 0x14:_0x1bb5d3=new THREE[(_0x593461(0x115))](_0x3ccd79),_0x457d5d=new CANNON['Sphere'](_0x3ccd79*0.9),_0x2c8876=0.8;break;default:_0x1bb5d3=new THREE[(_0x593461(0x1c2))](_0x3ccd79,_0x3ccd79,_0x3ccd79),_0x457d5d=new CANNON[(_0x593461(0x13d))](new CANNON['Vec3'](_0x3ccd79/0x2,_0x3ccd79/0x2,_0x3ccd79/0x2));}return{'geometry':_0x1bb5d3,'shape':_0x457d5d,'angularDamping':_0x2c8876};}function addDice(_0x3e9a62){const _0x13b500=a0_0x3dd0a7;if(!scene)return;const _0x5b730b=campaign[_0x13b500(0x1a7)][activeCharIndex],_0x3066b5=_0x5b730b?_0x5b730b[_0x13b500(0x139)]:diceConfigs[_0x3e9a62]['color'];try{const {geometry:_0x18ca63,shape:_0x19d844,angularDamping:_0x485bff}=createDiceGeometry(_0x3e9a62,0x1),_0x1aab11=new THREE[(_0x13b500(0x234))]({'color':_0x3066b5,'metalness':0.2,'roughness':0.1,'clearcoat':0x1,'flatShading':!![]}),_0x4d6a72=new THREE['Mesh'](_0x18ca63,_0x1aab11);_0x4d6a72[_0x13b500(0x1ea)]=!![],scene[_0x13b500(0x213)](_0x4d6a72);const _0x2f2dba=new CANNON[(_0x13b500(0x239))]({'mass':0x5,'shape':_0x19d844,'linearDamping':0.5,'angularDamping':_0x485bff,'material':matDice});_0x2f2dba[_0x13b500(0x10c)][_0x13b500(0x1bf)]((Math[_0x13b500(0x131)]()-0.5)*0x2,0x8,(Math[_0x13b500(0x131)]()-0.5)*0x2),_0x2f2dba[_0x13b500(0x251)][_0x13b500(0x1bf)](Math[_0x13b500(0x131)](),Math['random'](),Math[_0x13b500(0x131)](),Math['random']()),_0x2f2dba[_0x13b500(0x226)](_0x13b500(0x18c),handleDiceCollision),world['addBody'](_0x2f2dba),diceObjects[_0x13b500(0x1ba)]({'mesh':_0x4d6a72,'body':_0x2f2dba,'type':_0x3e9a62,'stopped':![]}),updateDiceButtonUI(_0x3e9a62,0x1),clearMagicEffects();}catch(_0x4a8e19){console[_0x13b500(0x1db)](_0x13b500(0x1d6),_0x4a8e19);}}function createSparkleTexture(){const _0xce714d=a0_0x3dd0a7,_0x5615a1=document['createElement'](_0xce714d(0x15a));_0x5615a1[_0xce714d(0x25b)]=0x20,_0x5615a1['height']=0x20;const _0x1fd229=_0x5615a1[_0xce714d(0x1d1)]('2d'),_0x4d0156=_0x1fd229[_0xce714d(0x22c)](0x10,0x10,0x0,0x10,0x10,0x10);return _0x4d0156['addColorStop'](0x0,_0xce714d(0x14b)),_0x4d0156[_0xce714d(0x219)](0x1,_0xce714d(0x23d)),_0x1fd229[_0xce714d(0x102)]=_0x4d0156,_0x1fd229[_0xce714d(0x136)](0x0,0x0,0x20,0x20),new THREE[(_0xce714d(0x1dd))](_0x5615a1);}function createNumberLabel(_0x386f3e,_0x52925a){const _0x1f7689=a0_0x3dd0a7,_0x398af4=document[_0x1f7689(0x180)](_0x1f7689(0x15a)),_0x18f6ce=0x100;_0x398af4[_0x1f7689(0x25b)]=_0x18f6ce,_0x398af4['height']=_0x18f6ce;const _0x59fe25=_0x398af4['getContext']('2d'),_0x4bbb94=parseInt(_0x52925a[_0x1f7689(0x26f)](0x1,0x3),0x10),_0x1c4581=parseInt(_0x52925a[_0x1f7689(0x26f)](0x3,0x5),0x10),_0x2f6247=parseInt(_0x52925a[_0x1f7689(0x26f)](0x5,0x7),0x10),_0xbd5b63=_0x59fe25['createRadialGradient'](_0x18f6ce/0x2,_0x18f6ce/0x2,0x14,_0x18f6ce/0x2,_0x18f6ce/0x2,0x6e);_0xbd5b63[_0x1f7689(0x219)](0x0,_0x1f7689(0x1c5)+_0x4bbb94+','+_0x1c4581+','+_0x2f6247+_0x1f7689(0x16c)),_0xbd5b63[_0x1f7689(0x219)](0x1,_0x1f7689(0x1c5)+_0x4bbb94+','+_0x1c4581+','+_0x2f6247+_0x1f7689(0x22d)),_0x59fe25['fillStyle']=_0xbd5b63,_0x59fe25['fillRect'](0x0,0x0,_0x18f6ce,_0x18f6ce),_0x59fe25[_0x1f7689(0x10a)]=_0x1f7689(0x108),_0x59fe25['textAlign']=_0x1f7689(0xea),_0x59fe25[_0x1f7689(0xf9)]=_0x1f7689(0x150),_0x59fe25[_0x1f7689(0x151)]=_0x1f7689(0xf4),_0x59fe25[_0x1f7689(0x231)]=0xa,_0x59fe25['fillStyle']='#ffffff',_0x59fe25['fillText'](_0x386f3e,_0x18f6ce/0x2,_0x18f6ce/0x2);const _0x3acaeb=new THREE[(_0x1f7689(0x20a))]({'map':new THREE[(_0x1f7689(0x1dd))](_0x398af4),'transparent':!![],'depthTest':![]}),_0x1e0d81=new THREE['Sprite'](_0x3acaeb);return _0x1e0d81[_0x1f7689(0x266)][_0x1f7689(0x1bf)](0.1,0.1,0x1),_0x1e0d81[_0x1f7689(0x225)]=0x3e7,_0x1e0d81;}function showFloatingResult(_0x276e4d,_0x507096){const _0x3ce3c0=a0_0x3dd0a7,_0x408924=campaign[_0x3ce3c0(0x1a7)][activeCharIndex],_0xb22753=_0x408924?_0x408924[_0x3ce3c0(0x139)]:_0x3ce3c0(0x277),_0x514283=createNumberLabel(_0x507096[_0x3ce3c0(0x147)](),_0xb22753);_0x514283['position'][_0x3ce3c0(0x134)](_0x276e4d[_0x3ce3c0(0x20f)][_0x3ce3c0(0x10c)]),_0x514283['position']['y']+=0.8,scene['add'](_0x514283),magicEffects[_0x3ce3c0(0x1ba)]({'mainSprite':_0x514283,'life':0x0,'maxLife':0x64,'color':_0xb22753,'particles':[]});if(_0x276e4d[_0x3ce3c0(0x178)]===0x14){if(_0x507096===0x14)hasCritHappened=!![],playSound(_0x3ce3c0(0x1a9)),document[_0x3ce3c0(0x209)][_0x3ce3c0(0x10e)][_0x3ce3c0(0x15f)](_0x3ce3c0(0x253)),document[_0x3ce3c0(0x209)][_0x3ce3c0(0x10e)]['add'](_0x3ce3c0(0x109),'shake-effect'),setTimeout(()=>{const _0x52086e=_0x3ce3c0;document[_0x52086e(0x209)][_0x52086e(0x10e)]['remove'](_0x52086e(0x109),'shake-effect');},0xfa0);else _0x507096===0x1&&!hasCritHappened&&(playSound(_0x3ce3c0(0x1ef)),document[_0x3ce3c0(0x209)][_0x3ce3c0(0x10e)]['add'](_0x3ce3c0(0x253),_0x3ce3c0(0x210)),setTimeout(()=>{const _0xab4673=_0x3ce3c0;if(!hasCritHappened)document[_0xab4673(0x209)][_0xab4673(0x10e)][_0xab4673(0x15f)](_0xab4673(0x253),_0xab4673(0x210));},0xfa0));}}function clearMagicEffects(){const _0x342d21=a0_0x3dd0a7;magicEffects[_0x342d21(0x15c)](_0x4b1107=>{const _0x535076=_0x342d21;scene['remove'](_0x4b1107[_0x535076(0x1e3)]),_0x4b1107[_0x535076(0x1c7)][_0x535076(0x15c)](_0x3f8da9=>scene[_0x535076(0x15f)](_0x3f8da9[_0x535076(0x20f)]));}),magicEffects=[];}let chargeAnimId=null,lastFrameTime=0x0;function startCharging(){const _0x1b4d21=a0_0x3dd0a7;if(diceObjects[_0x1b4d21(0x1c4)]===0x0||isRolling)return;isPressing=!![],clearMagicEffects(),pressPower=0.3,playSound(_0x1b4d21(0x23c));const _0xd40d2e=document[_0x1b4d21(0x22f)](_0x1b4d21(0x27c)),_0x48650e=document[_0x1b4d21(0x22f)](_0x1b4d21(0x250));if(chargeAnimId)cancelAnimationFrame(chargeAnimId);const _0x128aa8=0x3e8,_0xfda853=1.5,_0x213d33=_0xfda853-0.3;lastFrameTime=performance[_0x1b4d21(0x16b)]();const _0x596fde=_0x23ec3d=>{const _0xf649e=_0x1b4d21;if(!isPressing)return;const _0x4db9a7=_0x23ec3d-lastFrameTime;lastFrameTime=_0x23ec3d,pressPower+=_0x213d33/_0x128aa8*_0x4db9a7;if(pressPower>=_0xfda853)pressPower=_0xfda853;const _0x1e2187=Math[_0xf649e(0x1d9)](pressPower/_0xfda853*0x64,0x64);_0xd40d2e[_0xf649e(0x264)][_0xf649e(0x25b)]=_0x1e2187+'%';if(_0x1e2187>=0x64)_0x48650e[_0xf649e(0x10e)][_0xf649e(0x213)]('charged');if(pressPower<_0xfda853)chargeAnimId=requestAnimationFrame(_0x596fde);};chargeAnimId=requestAnimationFrame(_0x596fde);}function releaseRoll(){const _0x1de771=a0_0x3dd0a7;if(!isPressing)return;isPressing=![],chargeAnimId&&(cancelAnimationFrame(chargeAnimId),chargeAnimId=null),stopHoldSound(),document[_0x1de771(0x22f)]('powerBar')[_0x1de771(0x264)]['width']='0%',document[_0x1de771(0x22f)](_0x1de771(0x250))[_0x1de771(0x10e)][_0x1de771(0x15f)](_0x1de771(0xef)),diceObjects[_0x1de771(0x1c4)]>0x0&&!isRolling&&(playSound(_0x1de771(0x22b)),rollAllDice(pressPower)),pressPower=0x0;}function rollAllDice(_0x30476d){const _0x193931=a0_0x3dd0a7;isRolling=!![],hasCritHappened=![],clearMagicEffects();const _0x5ad4ee=_0x30476d*0x19;updateResultDisplay(_0x193931(0xf0),'?'),diceObjects[_0x193931(0x15c)](_0x530bfe=>{const _0x12e7cb=_0x193931;_0x530bfe[_0x12e7cb(0x17d)]=![],_0x530bfe[_0x12e7cb(0x209)][_0x12e7cb(0x220)](),_0x530bfe[_0x12e7cb(0x209)][_0x12e7cb(0x216)][_0x12e7cb(0x1bf)]((Math[_0x12e7cb(0x131)]()-0.5)*_0x5ad4ee,_0x5ad4ee*0.6+0x5,(Math[_0x12e7cb(0x131)]()-0.5)*_0x5ad4ee),_0x530bfe[_0x12e7cb(0x209)][_0x12e7cb(0x20e)][_0x12e7cb(0x1bf)]((Math[_0x12e7cb(0x131)]()-0.5)*0x3c,(Math[_0x12e7cb(0x131)]()-0.5)*0x3c,(Math['random']()-0.5)*0x3c);}),checkDiceStopped();}function checkDiceStopped(){const _0x1cfba6=a0_0x3dd0a7;if(!isRolling)return;let _0x460f4f=!![];diceObjects[_0x1cfba6(0x15c)](_0x2e4a03=>{const _0x735c9=_0x1cfba6;if(_0x2e4a03[_0x735c9(0x209)]['velocity'][_0x735c9(0x101)]()>0.1||_0x2e4a03['body'][_0x735c9(0x20e)][_0x735c9(0x101)]()>0.1)_0x460f4f=![];});if(_0x460f4f)setTimeout(calculateResults,0xc8);else requestAnimationFrame(checkDiceStopped);}function calculateResults(){const _0x5afec2=a0_0x3dd0a7;let _0x4065a9=0x0,_0x6db4e4=[],_0x4a6a9e=[],_0xbcc104=![],_0x3a3576=![];const _0x191d0a=document[_0x5afec2(0x22f)](_0x5afec2(0x13a));let _0x2ca645=parseInt(_0x191d0a[_0x5afec2(0xe9)])||0x0;const _0x2369f1=diceObjects[_0x5afec2(0x1af)](_0x5779a9=>{const _0x1710fa=_0x5afec2,_0x576963=Math[_0x1710fa(0x124)](Math[_0x1710fa(0x131)]()*_0x5779a9[_0x1710fa(0x178)])+0x1,_0x2eeec5={'val':_0x576963,'type':_0x5779a9[_0x1710fa(0x178)],'obj':_0x5779a9,'ignored':![]};if(_0x5779a9[_0x1710fa(0x178)]===0x14)_0x4a6a9e[_0x1710fa(0x1ba)](_0x2eeec5);return _0x2eeec5;});if(rollMode!==_0x5afec2(0x1ff)&&_0x4a6a9e[_0x5afec2(0x1c4)]>=0x2){if(rollMode==='advantage')_0x4a6a9e[_0x5afec2(0x19f)]((_0x414565,_0x1d0492)=>_0x1d0492[_0x5afec2(0x1ec)]-_0x414565['val']);else _0x4a6a9e[_0x5afec2(0x19f)]((_0x3730fc,_0x42dd13)=>_0x3730fc['val']-_0x42dd13[_0x5afec2(0x1ec)]);for(let _0x4f6a34=0x1;_0x4f6a34<_0x4a6a9e[_0x5afec2(0x1c4)];_0x4f6a34++)_0x4a6a9e[_0x4f6a34][_0x5afec2(0x160)]=!![];}_0x2369f1[_0x5afec2(0x15c)](_0x1bb2ec=>{const _0x4007e8=_0x5afec2;if(!_0x1bb2ec[_0x4007e8(0x160)]){_0x4065a9+=_0x1bb2ec[_0x4007e8(0x1ec)];if(_0x1bb2ec['type']===0x14){if(_0x1bb2ec[_0x4007e8(0x1ec)]===0x14)_0xbcc104=!![];if(_0x1bb2ec['val']===0x1)_0x3a3576=!![];}_0x6db4e4['push'](_0x1bb2ec[_0x4007e8(0x1ec)]+_0x4007e8(0x236)+_0x1bb2ec['type']+')'),_0x1bb2ec[_0x4007e8(0xf5)][_0x4007e8(0x20f)][_0x4007e8(0xff)][_0x4007e8(0x1e1)]=0x1,_0x1bb2ec[_0x4007e8(0xf5)][_0x4007e8(0x20f)][_0x4007e8(0xff)][_0x4007e8(0x176)]=0x0;}else _0x1bb2ec[_0x4007e8(0xf5)][_0x4007e8(0x20f)]['material']['opacity']=0.2,_0x1bb2ec[_0x4007e8(0xf5)][_0x4007e8(0x20f)][_0x4007e8(0xff)]['color'][_0x4007e8(0xfb)](0x333333),_0x6db4e4['push'](_0x4007e8(0x179)+_0x1bb2ec[_0x4007e8(0x1ec)]+'</span>');showFloatingResult(_0x1bb2ec[_0x4007e8(0xf5)],_0x1bb2ec['val']);}),_0x4065a9+=_0x2ca645;let _0x36e8bd=_0x6db4e4[_0x5afec2(0x1a6)](_0x5afec2(0x222));if(_0x2ca645!==0x0)_0x36e8bd+='\x20'+(_0x2ca645>0x0?'+':'')+_0x2ca645+_0x5afec2(0xfd);isRolling=![],updateResultDisplay(_0x36e8bd,_0x4065a9);if(_0xbcc104)triggerCritEffect(_0x5afec2(0x16d));else{if(_0x3a3576)triggerCritEffect(_0x5afec2(0x18d));}const _0xd8ca8=campaign[_0x5afec2(0x1a7)][activeCharIndex];if(_0xd8ca8){const _0x156fb4=_0x36e8bd[_0x5afec2(0x212)](/<[^>]*>?/gm,'');saveHistory(_0xd8ca8,_0x4065a9,_0x156fb4);if(!campaign[_0x5afec2(0x203)])campaign['globalLog']=[];const _0x128392=_0x2369f1[_0x5afec2(0x125)](_0x11d900=>_0x11d900[_0x5afec2(0x178)]===0x14&&!_0x11d900[_0x5afec2(0x160)]);campaign[_0x5afec2(0x203)][_0x5afec2(0x1ba)]({'charName':_0xd8ca8[_0x5afec2(0x194)],'charColor':_0xd8ca8[_0x5afec2(0x139)],'formula':_0x156fb4,'total':_0x4065a9,'rawD20':_0x128392?_0x128392[_0x5afec2(0x1ec)]:null,'timestamp':new Date()[_0x5afec2(0x233)]([],{'hour':'2-digit','minute':'2-digit'})});}saveData();}function triggerCritEffect(_0x3e9e1a){const _0x1080b3=a0_0x3dd0a7,_0x218ff3=document[_0x1080b3(0x209)];_0x3e9e1a===_0x1080b3(0x16d)?(_0x218ff3[_0x1080b3(0x10e)]['add'](_0x1080b3(0x109)),setTimeout(()=>_0x218ff3['classList'][_0x1080b3(0x15f)]('crit-success-flash'),0x3e8)):(_0x218ff3[_0x1080b3(0x10e)][_0x1080b3(0x213)](_0x1080b3(0x1d8),_0x1080b3(0x210)),setTimeout(()=>_0x218ff3[_0x1080b3(0x10e)]['remove'](_0x1080b3(0x1d8),_0x1080b3(0x210)),0x1f4));}function clearDice(){const _0x1ddc15=a0_0x3dd0a7;diceObjects[_0x1ddc15(0x15c)](_0x38fa91=>{const _0x1c1cfb=_0x1ddc15;if(_0x38fa91[_0x1c1cfb(0x20f)])scene[_0x1c1cfb(0x15f)](_0x38fa91[_0x1c1cfb(0x20f)]);if(_0x38fa91[_0x1c1cfb(0x209)])world[_0x1c1cfb(0x13f)](_0x38fa91[_0x1c1cfb(0x209)]);}),diceObjects=[],clearMagicEffects(),diceTypes['forEach'](_0x1f6616=>updateDiceButtonUI(_0x1f6616,0x0,!![])),updateResultDisplay('Adicione\x20dados...','0'),isRolling=![],playSound(_0x1ddc15(0x1f6));}function saveHistory(_0x537a29,_0x5863aa,_0x551f18){const _0x36f9be=a0_0x3dd0a7;if(!_0x537a29[_0x36f9be(0x262)])_0x537a29[_0x36f9be(0x262)]=[];_0x537a29['history'][_0x36f9be(0x1ba)]({'turn':_0x537a29[_0x36f9be(0x20d)]||0x1,'total':_0x5863aa,'formula':_0x551f18}),updateHistoryUI();}function updateHistoryUI(){const _0x84f4f2=a0_0x3dd0a7,_0x522ff9=campaign[_0x84f4f2(0x1a7)][activeCharIndex],_0x5f2fbf=document['getElementById'](_0x84f4f2(0x1b4));if(!_0x522ff9||!_0x5f2fbf)return;_0x5f2fbf['innerHTML']='';const _0x41f809=[..._0x522ff9[_0x84f4f2(0x262)]][_0x84f4f2(0x23f)]();if(_0x41f809[_0x84f4f2(0x1c4)]===0x0){_0x5f2fbf[_0x84f4f2(0x17b)]=_0x84f4f2(0x255);return;}_0x41f809[_0x84f4f2(0x15c)](_0x20313c=>{const _0x37b22f=_0x84f4f2,_0x4b68fb=document[_0x37b22f(0x180)]('li');_0x4b68fb[_0x37b22f(0x128)]='roll-entry',_0x4b68fb[_0x37b22f(0x17b)]=_0x37b22f(0x1c3)+_0x20313c['formula']+_0x37b22f(0x186)+_0x522ff9['color']+'\x22>'+_0x20313c[_0x37b22f(0x1ed)]+_0x37b22f(0x1f9),_0x5f2fbf[_0x37b22f(0x103)](_0x4b68fb);});}function toggleHistory(){const _0x27bc2f=a0_0x3dd0a7,_0x1d318d=document[_0x27bc2f(0x22f)](_0x27bc2f(0x200)),_0x3141ef=document[_0x27bc2f(0x22f)]('toggleHistoryBtn');if(!_0x1d318d||!_0x3141ef)return;const _0x45eb2f=_0x1d318d[_0x27bc2f(0x10e)][_0x27bc2f(0x280)](_0x27bc2f(0x240));_0x3141ef[_0x27bc2f(0x17a)]=_0x45eb2f?_0x27bc2f(0x1dc):_0x27bc2f(0x23b),playSound(_0x27bc2f(0xec));}function animate(){const _0x5a9e48=a0_0x3dd0a7;requestAnimationFrame(animate);const _0x8ebce=clock['getDelta']();if(world)world[_0x5a9e48(0x221)](0x1/0x3c,_0x8ebce,0x3);diceObjects[_0x5a9e48(0x15c)](_0x33b59c=>{const _0x1669a4=_0x5a9e48;_0x33b59c[_0x1669a4(0x20f)]&&_0x33b59c['body']&&(_0x33b59c[_0x1669a4(0x20f)][_0x1669a4(0x10c)]['copy'](_0x33b59c[_0x1669a4(0x209)][_0x1669a4(0x10c)]),_0x33b59c[_0x1669a4(0x20f)]['quaternion'][_0x1669a4(0x134)](_0x33b59c[_0x1669a4(0x209)][_0x1669a4(0x251)]));});for(let _0xe5e45e=magicEffects[_0x5a9e48(0x1c4)]-0x1;_0xe5e45e>=0x0;_0xe5e45e--){const _0x4ce103=magicEffects[_0xe5e45e];_0x4ce103[_0x5a9e48(0x270)]++;if(_0x4ce103['life']<0x64){_0x4ce103['mainSprite'][_0x5a9e48(0x10c)]['y']+=0.015;if(_0x4ce103[_0x5a9e48(0x270)]<0x14){const _0x23f30c=_0x4ce103[_0x5a9e48(0x270)]/0x14;_0x4ce103[_0x5a9e48(0x1e3)][_0x5a9e48(0x266)][_0x5a9e48(0x1bf)](_0x23f30c*2.5,_0x23f30c*2.5,0x1),_0x4ce103['mainSprite'][_0x5a9e48(0xff)]['opacity']=_0x23f30c;}else{if(_0x4ce103[_0x5a9e48(0x270)]>0x50)_0x4ce103[_0x5a9e48(0x1e3)]['material'][_0x5a9e48(0x1e1)]=(0x64-_0x4ce103[_0x5a9e48(0x270)])/0x14;}}if(_0x4ce103[_0x5a9e48(0x270)]<0x3c&&Math[_0x5a9e48(0x131)]()>0.3){const _0x467928=new THREE[(_0x5a9e48(0x20a))]({'map':sparkleTexture,'transparent':!![],'color':_0x4ce103[_0x5a9e48(0x139)],'opacity':0.8,'blending':THREE['AdditiveBlending']}),_0x51e911=new THREE['Sprite'](_0x467928);_0x51e911[_0x5a9e48(0x10c)][_0x5a9e48(0x134)](_0x4ce103['mainSprite'][_0x5a9e48(0x10c)]),_0x51e911['position']['x']+=(Math[_0x5a9e48(0x131)]()-0.5)*0.5,_0x51e911[_0x5a9e48(0x10c)]['y']-=0.2,_0x51e911['scale'][_0x5a9e48(0x1bf)](0.3,0.3,0x1),scene[_0x5a9e48(0x213)](_0x51e911),_0x4ce103[_0x5a9e48(0x1c7)][_0x5a9e48(0x1ba)]({'mesh':_0x51e911,'age':0x0});}for(let _0x24a4fb=_0x4ce103[_0x5a9e48(0x1c7)][_0x5a9e48(0x1c4)]-0x1;_0x24a4fb>=0x0;_0x24a4fb--){const _0x5ade38=_0x4ce103['particles'][_0x24a4fb];_0x5ade38[_0x5a9e48(0x27d)]++,_0x5ade38[_0x5a9e48(0x20f)][_0x5a9e48(0x10c)]['y']-=0.005,_0x5ade38[_0x5a9e48(0x20f)][_0x5a9e48(0xff)][_0x5a9e48(0x1e1)]-=0.03,_0x5ade38[_0x5a9e48(0x20f)][_0x5a9e48(0x266)]['multiplyScalar'](0.95),_0x5ade38[_0x5a9e48(0x20f)][_0x5a9e48(0xff)][_0x5a9e48(0x1e1)]<=0x0&&(scene[_0x5a9e48(0x15f)](_0x5ade38[_0x5a9e48(0x20f)]),_0x4ce103[_0x5a9e48(0x1c7)]['splice'](_0x24a4fb,0x1));}_0x4ce103['life']>=0x64&&_0x4ce103[_0x5a9e48(0x1c7)][_0x5a9e48(0x1c4)]===0x0&&(scene[_0x5a9e48(0x15f)](_0x4ce103[_0x5a9e48(0x1e3)]),magicEffects['splice'](_0xe5e45e,0x1));}if(renderer&&scene&&camera)renderer['render'](scene,camera);}document[a0_0x3dd0a7(0x226)](a0_0x3dd0a7(0xec),_0x19a235=>{const _0x17c1b5=a0_0x3dd0a7;if(_0x19a235[_0x17c1b5(0x165)]['id']===_0x17c1b5(0x25a)){playSound(_0x17c1b5(0x1fd));return;}if(_0x19a235[_0x17c1b5(0x165)]['closest'](_0x17c1b5(0x153))||_0x19a235['target'][_0x17c1b5(0x1d3)](_0x17c1b5(0x197))){playSound(_0x17c1b5(0x1f6));return;}if(_0x19a235[_0x17c1b5(0x165)][_0x17c1b5(0x1d3)]('#rollBtn'))return;if(_0x19a235['target'][_0x17c1b5(0x1d3)](_0x17c1b5(0x12f))||_0x19a235[_0x17c1b5(0x165)][_0x17c1b5(0x1d3)](_0x17c1b5(0x1ad))||_0x19a235[_0x17c1b5(0x165)]['closest']('input')||_0x19a235['target'][_0x17c1b5(0x1d3)](_0x17c1b5(0x14e))||_0x19a235[_0x17c1b5(0x165)][_0x17c1b5(0x1d3)]('i'))playSound(_0x17c1b5(0xec));setupModPicker();});function handleDiceCollision(_0x2cb44a){const _0x5e2b3f=a0_0x3dd0a7,_0x53d09f=Math[_0x5e2b3f(0x1c6)](_0x2cb44a[_0x5e2b3f(0x149)]['getImpactVelocityAlongNormal']());if(_0x53d09f<0.5)return;const _0x49fb76=Date['now']();if(_0x49fb76-lastCollisionTime<0x28)return;lastCollisionTime=_0x49fb76;let _0x22318f=0x0;if(_0x53d09f<0x2)_0x22318f=0x0;else{if(_0x53d09f<0x4)_0x22318f=0x1;else{if(_0x53d09f<0x6)_0x22318f=0x2;else{if(_0x53d09f<0x8)_0x22318f=0x3;else _0x22318f=0x4;}}}playSound(_0x5e2b3f(0x1fc),_0x22318f);}function setupModPicker(){const _0x5478c7=a0_0x3dd0a7,_0x4cf064=document['getElementById'](_0x5478c7(0x27e));if(!_0x4cf064)return;_0x4cf064['innerHTML']='';for(let _0x1293c6=-0xa;_0x1293c6<=0xa;_0x1293c6++){const _0x3bb529=document['createElement']('button');_0x3bb529['className']=_0x5478c7(0x14f),_0x3bb529[_0x5478c7(0x17a)]=(_0x1293c6>0x0?'+':'')+_0x1293c6,_0x3bb529[_0x5478c7(0xfa)]=()=>selectMod(_0x1293c6),_0x4cf064[_0x5478c7(0x103)](_0x3bb529);}}function toggleModPicker(){const _0xae67d=a0_0x3dd0a7,_0x5eea69=document[_0xae67d(0x22f)](_0xae67d(0x278)),_0x30b5a9=_0x5eea69[_0xae67d(0x264)][_0xae67d(0xfe)]==='none';_0x5eea69['style'][_0xae67d(0xfe)]=_0x30b5a9?_0xae67d(0x22a):_0xae67d(0x273),_0x30b5a9&&(playSound('click'),highlightActiveMod());}function selectMod(_0x52754a){const _0x21e0d1=a0_0x3dd0a7,_0x3da7cd=document['getElementById']('modInput'),_0x4a329c=document[_0x21e0d1(0x22f)](_0x21e0d1(0x243));_0x3da7cd[_0x21e0d1(0xe9)]=_0x52754a,_0x4a329c['innerText']=(_0x52754a>0x0?'+':'')+_0x52754a;if(campaign['characters'][activeCharIndex])campaign[_0x21e0d1(0x1a7)][activeCharIndex][_0x21e0d1(0x14c)]=_0x52754a;saveData(),toggleModPicker(),playSound(_0x21e0d1(0x1f6));}function highlightActiveMod(){const _0x6d8e95=a0_0x3dd0a7,_0x5c2901=parseInt(document[_0x6d8e95(0x22f)](_0x6d8e95(0x13a))[_0x6d8e95(0xe9)])||0x0;document[_0x6d8e95(0x157)](_0x6d8e95(0x205))[_0x6d8e95(0x15c)](_0x49095d=>{const _0xa588e=_0x6d8e95,_0xed0569=parseInt(_0x49095d['innerText']);_0x49095d[_0xa588e(0x10e)][_0xa588e(0x280)](_0xa588e(0x214),_0xed0569===_0x5c2901);});}function setRollMode(_0x4b4ae1){const _0x60d15b=a0_0x3dd0a7;rollMode=_0x4b4ae1;if(campaign[_0x60d15b(0x1a7)][activeCharIndex])campaign['characters'][activeCharIndex][_0x60d15b(0x20b)]=_0x4b4ae1;const _0x289a00=document['getElementById'](_0x60d15b(0x24b));if(!_0x289a00)return;_0x289a00['classList'][_0x60d15b(0x15f)](_0x60d15b(0x1e2),_0x60d15b(0x122),_0x60d15b(0x105));if(_0x4b4ae1===_0x60d15b(0x1ff))_0x289a00['innerText']=_0x60d15b(0x238),_0x289a00[_0x60d15b(0x10e)]['add'](_0x60d15b(0x1e2));else{if(_0x4b4ae1===_0x60d15b(0x24d))_0x289a00[_0x60d15b(0x17a)]=_0x60d15b(0xfc),_0x289a00[_0x60d15b(0x10e)][_0x60d15b(0x213)](_0x60d15b(0x122));else _0x4b4ae1==='disadvantage'&&(_0x289a00['innerText']=_0x60d15b(0x269),_0x289a00[_0x60d15b(0x10e)]['add'](_0x60d15b(0x105)));}}function cycleRollMode(){const _0x466d44=a0_0x3dd0a7;playSound(_0x466d44(0xec));if(rollMode===_0x466d44(0x1ff))setRollMode(_0x466d44(0x24d));else{if(rollMode===_0x466d44(0x24d))setRollMode(_0x466d44(0x10b));else setRollMode(_0x466d44(0x1ff));}}function openGlobalLog(){const _0x4eb812=a0_0x3dd0a7,_0xe3e3de=document['getElementById'](_0x4eb812(0x145)),_0x131d1c=document['getElementById'](_0x4eb812(0xee));if(!campaign['globalLog'])campaign[_0x4eb812(0x203)]=[];let _0x1378dd={};campaign[_0x4eb812(0x203)]['forEach'](_0x206129=>{const _0x26dc8d=_0x4eb812;if(_0x206129[_0x26dc8d(0x24f)]!==null&&_0x206129[_0x26dc8d(0x24f)]!==undefined){if(!_0x1378dd[_0x206129[_0x26dc8d(0x21f)]])_0x1378dd[_0x206129[_0x26dc8d(0x21f)]]={'sum':0x0,'count':0x0};_0x1378dd[_0x206129[_0x26dc8d(0x21f)]]['sum']+=_0x206129[_0x26dc8d(0x24f)],_0x1378dd[_0x206129[_0x26dc8d(0x21f)]]['count']++;}});let _0x449653=-0x1,_0x17d3fa=0x15,_0x1d9ee6='--',_0x3c43aa='--';for(const [_0x534c51,_0x3e3746]of Object['entries'](_0x1378dd)){if(_0x3e3746[_0x4eb812(0x24c)]>0x0){const _0x4ae967=_0x3e3746[_0x4eb812(0x248)]/_0x3e3746[_0x4eb812(0x24c)];_0x4ae967>_0x449653&&(_0x449653=_0x4ae967,_0x1d9ee6=_0x534c51),_0x4ae967<_0x17d3fa&&(_0x17d3fa=_0x4ae967,_0x3c43aa=_0x534c51);}}document[_0x4eb812(0x22f)]('statLuckyName')[_0x4eb812(0x17a)]=_0x1d9ee6,document[_0x4eb812(0x22f)](_0x4eb812(0x26d))[_0x4eb812(0x17a)]=_0x449653>-0x1?_0x4eb812(0x198)+_0x449653[_0x4eb812(0x1a8)](0x1):_0x4eb812(0x16e),document[_0x4eb812(0x22f)]('statUnluckyName')[_0x4eb812(0x17a)]=_0x3c43aa,document['getElementById']('statUnluckyVal')['innerText']=_0x17d3fa<0x15?_0x4eb812(0x198)+_0x17d3fa['toFixed'](0x1):_0x4eb812(0x16e),_0x131d1c[_0x4eb812(0x17b)]='',[...campaign[_0x4eb812(0x203)]][_0x4eb812(0x23f)]()[_0x4eb812(0x15c)](_0x54cfee=>{const _0x3d35c8=_0x4eb812,_0xb887d3=document[_0x3d35c8(0x180)]('li');_0xb887d3[_0x3d35c8(0x128)]=_0x3d35c8(0x271);let _0x21452a=_0x3d35c8(0x247);if(_0x54cfee[_0x3d35c8(0x24f)]===0x14)_0x21452a+=_0x3d35c8(0x1b6);if(_0x54cfee[_0x3d35c8(0x24f)]===0x1)_0x21452a+=_0x3d35c8(0xf2);_0xb887d3['innerHTML']=_0x3d35c8(0x1c0)+_0x54cfee[_0x3d35c8(0x15e)]+'\x22>'+_0x54cfee[_0x3d35c8(0x21f)]+_0x3d35c8(0x229)+_0x54cfee['timestamp']+_0x3d35c8(0x275)+_0x21452a+'\x22>'+_0x54cfee[_0x3d35c8(0x1ed)]+_0x3d35c8(0x1e4)+_0x54cfee[_0x3d35c8(0x256)]+_0x3d35c8(0x181),_0x131d1c[_0x3d35c8(0x103)](_0xb887d3);}),_0xe3e3de['style'][_0x4eb812(0xfe)]=_0x4eb812(0x22a),playSound(_0x4eb812(0xec));}function openCompendium(){const _0x59929a=a0_0x3dd0a7,_0x410ffe=document['getElementById']('compendiumModal');if(_0x410ffe){_0x410ffe[_0x59929a(0x264)]['display']=_0x59929a(0x22a);if(typeof rulesData!==_0x59929a(0x232))renderRules(rulesData);playSound(_0x59929a(0xec));}}function getLevelValue(_0x166e5e){const _0x5ed788=a0_0x3dd0a7;if(_0x166e5e['category']!==_0x5ed788(0x215))return-0x1;if(_0x166e5e['meta']['includes'](_0x5ed788(0x1be)))return 0x0;const _0x205bb2=_0x166e5e[_0x5ed788(0x1a1)][_0x5ed788(0x15b)](/(\d+)º/);return _0x205bb2?parseInt(_0x205bb2[0x1]):0x0;}function getSortPriority(_0x8d413b){const _0x297a78=a0_0x3dd0a7;if(_0x8d413b[_0x297a78(0x1df)][_0x297a78(0x1ae)](_0x297a78(0x279)))return 0x1;if(_0x8d413b[_0x297a78(0x1df)][_0x297a78(0x1ae)](_0x297a78(0x164)))return 0x2;const _0x13c1de=_0x8d413b[_0x297a78(0x1a1)]?_0x8d413b[_0x297a78(0x1a1)][_0x297a78(0x15b)](/Nível (\d+)/):null;if(_0x13c1de)return 0xa+parseInt(_0x13c1de[0x1]);if(_0x8d413b[_0x297a78(0x1a1)]&&_0x8d413b['meta']['includes'](_0x297a78(0x258)))return 0x64;return 0x32;}function a0_0x1d86(_0x416714,_0x1e0761){_0x416714=_0x416714-0xe8;const _0x183b31=a0_0x183b();let _0x1d86cf=_0x183b31[_0x416714];return _0x1d86cf;}function renderRules(_0x5cc664){const _0x333439=a0_0x3dd0a7,_0x4e9ba4=document[_0x333439(0x22f)]('rulesList');if(!_0x4e9ba4)return;_0x4e9ba4['innerHTML']='';if(_0x5cc664[_0x333439(0x1c4)]===0x0){_0x4e9ba4[_0x333439(0x17b)]=_0x333439(0x172);return;}const _0x8cc33c=[..._0x5cc664]['sort']((_0x38e9ad,_0x56ceb2)=>{const _0x2d4997=_0x333439,_0x3d18ec={'condition':0x1,'action':0x1,'combat':0x1,'env':0x1,'class':0x2,'species':0x2,'feat':0x3,'spell':0x4,'equipment':0x5};if(_0x3d18ec[_0x38e9ad[_0x2d4997(0x114)]]!==_0x3d18ec[_0x56ceb2[_0x2d4997(0x114)]])return(_0x3d18ec[_0x38e9ad[_0x2d4997(0x114)]]||0x63)-(_0x3d18ec[_0x56ceb2['category']]||0x63);if(['class',_0x2d4997(0x245),_0x2d4997(0x1f3),_0x2d4997(0x1bd)][_0x2d4997(0x1ae)](_0x38e9ad[_0x2d4997(0x114)])){if(_0x38e9ad['parentClass']!==_0x56ceb2[_0x2d4997(0x265)])return _0x38e9ad[_0x2d4997(0x265)][_0x2d4997(0x118)](_0x56ceb2[_0x2d4997(0x265)]);const _0x5493d8=typeof getSortPriority===_0x2d4997(0x276)?getSortPriority(_0x38e9ad):0x32,_0x57aa5d=typeof getSortPriority==='function'?getSortPriority(_0x56ceb2):0x32;if(_0x5493d8!==_0x57aa5d)return _0x5493d8-_0x57aa5d;return _0x38e9ad[_0x2d4997(0x1df)]['localeCompare'](_0x56ceb2[_0x2d4997(0x1df)]);}const _0x58035c=typeof getLevelValue==='function'?getLevelValue(_0x38e9ad):0x0,_0xcdd1ee=typeof getLevelValue===_0x2d4997(0x276)?getLevelValue(_0x56ceb2):0x0;if(_0x58035c!==_0xcdd1ee)return _0x58035c-_0xcdd1ee;return _0x38e9ad['title'][_0x2d4997(0x118)](_0x56ceb2[_0x2d4997(0x1df)]);});let _0x249141='';_0x8cc33c['forEach'](_0x3c513a=>{const _0x104cca=_0x333439;let _0x1b2053='',_0x534cc0='';if(_0x3c513a['category']==='spell'){const _0x230b9f=getLevelValue(_0x3c513a);_0x1b2053=_0x230b9f===0x0?_0x104cca(0x244):_0x104cca(0x211)+_0x230b9f+'º',_0x534cc0=_0x104cca(0x260)+_0x230b9f;}else{if(['class',_0x104cca(0x245),_0x104cca(0x1f3),'feat']['includes'](_0x3c513a[_0x104cca(0x114)])){_0x1b2053=_0x3c513a[_0x104cca(0x265)];const _0x7c24a6=_0x1b2053[_0x104cca(0x129)]()[_0x104cca(0x252)](_0x104cca(0x192))['replace'](/[\u0300-\u036f]/g,'')[_0x104cca(0x212)](/\s+/g,'');_0x534cc0=_0x104cca(0xf8)+_0x7c24a6;}else _0x1b2053=null;}if(_0x1b2053&&_0x249141!==_0x1b2053){_0x249141=_0x1b2053;const _0x42dab4=document[_0x104cca(0x180)](_0x104cca(0xf3));_0x42dab4['className']='level-header\x20'+_0x534cc0,_0x42dab4['innerText']=_0x1b2053,_0x4e9ba4['appendChild'](_0x42dab4);}const _0xa1ded7=document['createElement'](_0x104cca(0xf3));_0xa1ded7['className']=_0x104cca(0x208);let _0x292fe8=translateCategory(_0x3c513a['category']),_0x5d1e4f='';if([_0x104cca(0x1a2),_0x104cca(0x245),_0x104cca(0x1f3),_0x104cca(0x1bd)]['includes'](_0x3c513a[_0x104cca(0x114)])){_0x292fe8=_0x3c513a[_0x104cca(0x265)];const _0x12eb9e=_0x292fe8['toLowerCase']()[_0x104cca(0x252)](_0x104cca(0x192))['replace'](/[\u0300-\u036f]/g,'')[_0x104cca(0x212)](/\s+/g,'');_0x5d1e4f=_0x104cca(0x1cf)+_0x12eb9e;}else _0x5d1e4f=_0x104cca(0x1cf)+_0x3c513a['category'];let _0x3acd9e=_0x3c513a[_0x104cca(0x1a1)]?_0x104cca(0x148)+_0x3c513a[_0x104cca(0x1a1)]+_0x104cca(0x1c1):'';_0xa1ded7['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22rule-title\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+_0x3c513a[_0x104cca(0x1df)]+_0x104cca(0x196)+_0x5d1e4f+_0x104cca(0x11a)+(_0x3c513a[_0x104cca(0x114)]===_0x104cca(0x215)?_0x104cca(0xf7):'')+'\x22>'+_0x292fe8+_0x104cca(0x1f2)+_0x3acd9e+_0x104cca(0x11c)+_0x3c513a['text']+_0x104cca(0x159),_0x4e9ba4[_0x104cca(0x103)](_0xa1ded7);});}function translateCategory(_0x5ce7f9){const _0x3a81b4=a0_0x3dd0a7;if(_0x5ce7f9===_0x3a81b4(0x12c))return _0x3a81b4(0x1aa);if(_0x5ce7f9==='action')return _0x3a81b4(0x177);if(_0x5ce7f9===_0x3a81b4(0x1cc))return'Regra';if(_0x5ce7f9===_0x3a81b4(0x215))return'Magia';if(_0x5ce7f9===_0x3a81b4(0x144))return _0x3a81b4(0x1f5);if(_0x5ce7f9===_0x3a81b4(0x245))return _0x3a81b4(0x249);if(_0x5ce7f9===_0x3a81b4(0x1f3))return _0x3a81b4(0x10d);if(_0x5ce7f9===_0x3a81b4(0x1bd))return _0x3a81b4(0x27a);return _0x5ce7f9;}function filterRules(){const _0x3495b8=a0_0x3dd0a7,_0x1858ec=document[_0x3495b8(0x22f)](_0x3495b8(0x26a));if(!_0x1858ec||typeof rulesData===_0x3495b8(0x232))return;const _0x13503c=normalizeText(_0x1858ec[_0x3495b8(0xe9)][_0x3495b8(0x193)]());let _0x770e96=_0x13503c;_0x13503c['length']>0x3&&(_0x770e96=_0x13503c[_0x3495b8(0x212)](/(r|s)$/,''));const _0x7a6cb5=rulesData[_0x3495b8(0x21d)](_0x19c9d9=>{const _0x2d348d=_0x3495b8,_0x160999=normalizeText(_0x19c9d9[_0x2d348d(0x1df)]),_0x5252b7=normalizeText(_0x19c9d9[_0x2d348d(0x1b5)]),_0x2b5b2a=normalizeText(_0x19c9d9[_0x2d348d(0x1a1)]||''),_0x3a633a=_0x160999['includes'](_0x13503c)||_0x160999[_0x2d348d(0x1ae)](_0x770e96),_0x3cc79d=_0x5252b7[_0x2d348d(0x1ae)](_0x13503c)||_0x5252b7['includes'](_0x770e96),_0x4f610c=_0x2b5b2a[_0x2d348d(0x1ae)](_0x13503c)||_0x2b5b2a[_0x2d348d(0x1ae)](_0x770e96);return _0x3a633a||_0x3cc79d||_0x4f610c;});renderRules(_0x7a6cb5),document[_0x3495b8(0x157)](_0x3495b8(0x19e))[_0x3495b8(0x15c)](_0x10984d=>_0x10984d[_0x3495b8(0x10e)][_0x3495b8(0x15f)](_0x3495b8(0x214)));}function normalizeText(_0x544509){const _0x32ece1=a0_0x3dd0a7;if(!_0x544509)return'';return _0x544509[_0x32ece1(0x252)](_0x32ece1(0x192))['replace'](/[\u0300-\u036f]/g,'')[_0x32ece1(0x129)]();}function filterCategory(_0x31434d){const _0x3cea6d=a0_0x3dd0a7;document[_0x3cea6d(0x157)]('.cat-btn')[_0x3cea6d(0x15c)](_0x46aa16=>_0x46aa16[_0x3cea6d(0x10e)]['remove']('active'));if(event&&event[_0x3cea6d(0x165)])event[_0x3cea6d(0x165)]['classList'][_0x3cea6d(0x213)](_0x3cea6d(0x214));const _0x1fafee=document['getElementById'](_0x3cea6d(0x26a));if(_0x1fafee)_0x1fafee['value']='';if(typeof rulesData==='undefined')return;if(_0x31434d===_0x3cea6d(0x175))renderRules(rulesData);else{const _0x198dc7=rulesData['filter'](_0x5b8112=>_0x5b8112[_0x3cea6d(0x114)]===_0x31434d);renderRules(_0x198dc7);}}function setupEventListeners(){const _0xb818f2=a0_0x3dd0a7,_0x9812d7=document['getElementById']('addCharBtn');if(_0x9812d7)_0x9812d7[_0xb818f2(0xfa)]=addCharacterPreview;const _0x1f6222=document[_0xb818f2(0x22f)]('startCampaignBtn');if(_0x1f6222)_0x1f6222[_0xb818f2(0xfa)]=startCampaign;const _0x2d9c5a=document[_0xb818f2(0x22f)](_0xb818f2(0x250));_0x2d9c5a&&(_0x2d9c5a['addEventListener'](_0xb818f2(0x1b9),startCharging),window[_0xb818f2(0x226)](_0xb818f2(0x19d),releaseRoll),_0x2d9c5a[_0xb818f2(0x226)](_0xb818f2(0x25e),_0x3b8152=>{const _0xf7543=_0xb818f2;_0x3b8152[_0xf7543(0x1f1)](),startCharging();}),window['addEventListener'](_0xb818f2(0x184),releaseRoll));const _0x71dd2d=document[_0xb818f2(0x22f)](_0xb818f2(0x187));if(_0x71dd2d)_0x71dd2d['onclick']=clearDice;const _0x177005=document['getElementById']('toggleHistoryBtn');if(_0x177005)_0x177005[_0xb818f2(0xfa)]=toggleHistory;window['addEventListener'](_0xb818f2(0x235),refreshCanvasSize);}document[a0_0x3dd0a7(0x226)](a0_0x3dd0a7(0x202),()=>{setupEventListeners();});function openDonation(){const _0x4181cd=a0_0x3dd0a7,_0xe94c05=_0x4181cd(0x1f4);playSound(_0x4181cd(0xec)),window['open'](_0xe94c05,'_blank');}document[a0_0x3dd0a7(0x226)](a0_0x3dd0a7(0x182),_0x504dd6=>_0x504dd6[a0_0x3dd0a7(0x1f1)]()),document[a0_0x3dd0a7(0x267)]=function(_0x56dbce){const _0x2067b4=a0_0x3dd0a7;if(_0x56dbce[_0x2067b4(0x15d)]==0x7b)return![];if(_0x56dbce['ctrlKey']&&_0x56dbce[_0x2067b4(0x111)]&&(_0x56dbce[_0x2067b4(0x15d)]=='I'[_0x2067b4(0x166)](0x0)||_0x56dbce[_0x2067b4(0x15d)]=='C'['charCodeAt'](0x0)||_0x56dbce[_0x2067b4(0x15d)]=='J'[_0x2067b4(0x166)](0x0)))return![];if(_0x56dbce[_0x2067b4(0x1e0)]&&_0x56dbce['keyCode']=='U'[_0x2067b4(0x166)](0x0))return![];};function hideSplashScreen(){const _0x531abc=a0_0x3dd0a7,_0x5f48f3=document[_0x531abc(0x22f)](_0x531abc(0x1cd));_0x5f48f3&&(console[_0x531abc(0xeb)]('Rollen:\x20Finalizando\x20carregamento...'),_0x5f48f3[_0x531abc(0x10e)][_0x531abc(0x213)]('splash-hidden'),setTimeout(()=>{const _0x1adda7=_0x531abc;_0x5f48f3[_0x1adda7(0x264)][_0x1adda7(0xfe)]='none';},0x320));}window[a0_0x3dd0a7(0x226)](a0_0x3dd0a7(0x1ce),hideSplashScreen),setTimeout(()=>{const _0x21e93c=a0_0x3dd0a7,_0x357129=document[_0x21e93c(0x22f)](_0x21e93c(0x1cd));_0x357129&&!_0x357129['classList']['contains'](_0x21e93c(0x224))&&(console[_0x21e93c(0x237)](_0x21e93c(0x1d5)),hideSplashScreen());},0x1388);function a0_0x183b(){const _0x4f843e=['combat','splash-screen','load','tag-','col','getContext','./hold.mp3','closest','DodecahedronGeometry','Rollen:\x20O\x20carregamento\x20demorou\x20demais.\x20Forçando\x20entrada.','Erro\x20ao\x20gerar\x20dado:','AmbientLight','crit-fail-flash','min','domElement','error','Ocultar\x20Histórico','CanvasTexture','<div\x20class=\x22tab-avatar\x22>','title','ctrlKey','opacity','mode-norm','mainSprite','</span><span\x20class=\x22log-formula\x22>','PointLight','getData','<img\x20src=\x22dragonbornm.png\x22\x20class=\x22avatar-img\x22\x20alt=\x22Dracono\x22>','state','164673jXDCtq','castShadow','Save\x20corrompido,\x20resetando.','val','total','ondrop','fumble','degToRad','preventDefault','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','equipment','https://apoia.se/rollenapp','Ambiente','touch','gain','settingsMenu','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','<img\x20src=\x22humanf.png\x22\x20class=\x22avatar-img\x22\x20alt=\x22Humana\x22>','dice-btn','collides','start','resume','normal','historyPanel','currentAvatarDisplay','DOMContentLoaded','globalLog','updateProjectionMatrix','.mod-btn','./touch.mp3','OctahedronGeometry','rule-card','body','SpriteMaterial','rollMode','setSize','turnCount','angularVelocity','mesh','shake-effect','Círculo\x20','replace','add','active','spell','velocity','splice','./fumble.mp3','addColorStop','btn-d','borderColor','<img\x20src=\x22aesimarf.png\x22\x20class=\x22avatar-img\x22\x20alt=\x22Aesimar\x20M\x22>','filter','<div\x20class=\x22preview-avatar\x22\x20style=\x22border-color:','charName','wakeUp','step','\x20+\x20','<img\x20src=\x22gnomef.png\x22\x20class=\x22avatar-img\x22\x20alt=\x22Gnoma\x22>','splash-hidden','renderOrder','addEventListener','isArray','input','</span><span\x20class=\x22log-time\x22>','flex','shoot','createRadialGradient',',0)','draggable','getElementById','./crit.mp3','shadowBlur','undefined','toLocaleTimeString','MeshPhysicalMaterial','resize','\x20(D','warn','NORMAL','Body','charListPreview','Ver\x20Histórico','hold','rgba(255,255,255,0)','VOLTAR\x20AO\x20JOGO','reverse','open','webkitAudioContext','devicePixelRatio','modDisplay','Truques\x20(Nível\x200)','species','PCFSoftShadowMap','log-total','sum','Raça','14JWQYJU','cycleVantBtn','count','advantage','connect','rawD20','rollBtn','quaternion','normalize','nat1-effect','./click.mp3','<li\x20style=\x27text-align:center;\x20opacity:0.5;\x20padding:20px;\x27>Nenhuma\x20rolagem\x20ainda...</li>','formula','30182DKWgoo','Subclasse','text/plain','startCampaignBtn','width','charTabsContainer','left','touchstart','11073710xIlEOC','lvl-','top','history','tan','style','parentClass','scale','onkeydown','Aventura','DESVANTAGEM','ruleSearch','<img\x20src=\x22halforcf.png\x22\x20class=\x22avatar-img\x22\x20alt=\x22Orc\x20F\x22>','ContactMaterial','statLuckyVal','./collide5.mp3','slice','life','global-log-entry','setPixelRatio','none','master','</span></div><div\x20class=\x22log-result-box\x22><span\x20class=\x22','function','#ffffff','modPickerModal','Visão\x20Geral','Talento','resultFormula','powerBar','age','modGrid','\x20<span\x20class=\x22dice-count\x22\x20id=\x22count-d','toggle','shadowMap','value','center','log','click','5BDVLby','globalLogList','charged','Rolando...','<img\x20src=\x22halfelfm.png\x22\x20class=\x22avatar-img\x22\x20alt=\x22Meio\x20Elfo\x22>','\x20log-crit-fail','div','rgba(0,0,0,0.8)','obj','createBufferSource','#7b1fa2','header-','textBaseline','onclick','setHex','VANTAGEM','\x20(Mod)','display','material','NaiveBroadphase','norm','fillStyle','appendChild','suspended','mode-dis','<img\x20src=\x22familiar.png\x22\x20class=\x22avatar-img\x22\x20alt=\x22Familiar\x22>','1708256xwaUQA','bold\x20110px\x20Arial','crit-success-flash','font','disadvantage','position','Item','classList','appContainer','disabled','shiftKey','</span>','clear','category','IcosahedronGeometry','shapes','0.5','localeCompare','./collide3.mp3','\x22\x20style=\x22background:','TetrahedronGeometry','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22rule-desc\x22>','resultTotal','dataTransfer','<img\x20src=\x22boss.png\x22\x20class=\x22avatar-img\x22\x20alt=\x22Chefe\x22>','decodeAudioData','<img\x20src=\x22monster.png\x22\x20class=\x22avatar-img\x22\x20alt=\x22Monstro\x22>','mode-adv','<img\x20src=\x22elfwoodm.png\x22\x20class=\x22avatar-img\x22\x20alt=\x22Elfo\x20da\x20Floresta\x20M\x22>','floor','find','stop','charNameInput','className','toLowerCase','<img\x20src=\x22elfdrowm.png\x22\x20class=\x22avatar-img\x22\x20alt=\x22Drow\x20M\x22>','avatar-option\x20','condition','Erro\x20ao\x20adicionar:','</div><span\x20style=\x22color:','button','Vec3','random','Histórico\x20limpo!','selected','copy','clientWidth','fillRect','Erro\x20ao\x20salvar','enabled','color','modInput','gravity','PerspectiveCamera','Box','<img\x20src=\x22aesimarm.png\x22\x20class=\x22avatar-img\x22\x20alt=\x22Aesimar\x20M\x22>','removeBody','INICIAR\x20JORNADA','AudioContext','Erro\x20loadData','reload','env','globalLogModal','addBody','toString','<div\x20style=\x22font-size:0.75rem;\x20color:#d84315;\x20font-style:italic;\x20margin-bottom:8px;\x20border-bottom:1px\x20dashed\x20rgba(0,0,0,0.1);\x20padding-bottom:4px;\x22>','contact','activeCharIndex','rgba(255,255,255,1)','modifier','avatar','select','mod-btn','middle','shadowColor','aspect','.char-tab','<img\x20src=\x22elfhighm.png\x22\x20class=\x22avatar-img\x22\x20alt=\x22High\x20Elfo\x22>','1058577rOUkwK','buffer','querySelectorAll','svg','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','canvas','match','forEach','keyCode','charColor','remove','ignored','stringify','setItem','<img\x20src=\x22halforcm.png\x22\x20class=\x22avatar-img\x22\x20alt=\x22Orc\x20M\x22>','Traços\x20Principais','target','charCodeAt','playbackRate','solver','parse','DirectionalLight','now',',0.6)','success','Média:\x20-','42POPYBu','<img\x20src=\x22dragonbornf.png\x22\x20class=\x22avatar-img\x22\x20alt=\x22Dracona\x22>','<img\x20src=\x22bhumanm.png\x22\x20class=\x22avatar-img\x22\x20alt=\x22Humano\x22>','<div\x20style=\x27text-align:center;\x20color:#5d4037;\x20margin-top:20px;\x27>Nenhum\x20conhecimento\x20encontrado...</div>','<img\x20src=\x22tieflingf.png\x22\x20class=\x22avatar-img\x22\x20alt=\x22Tiefling\x20F\x22>','281272rsZCsA','all','emissiveIntensity','Ação','type','<span\x20style=\x22text-decoration:\x20line-through;\x20opacity:\x200.5;\x22>','innerText','innerHTML','<img\x20src=\x22bhumanf.png\x22\x20class=\x22avatar-img\x22\x20alt=\x22Humana\x22>','stopped','World','setData','createElement','</span></div>','contextmenu','loop','touchend','entries','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22roll-equals\x22>=</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22roll-total\x22\x20style=\x22color:','clearBtn','setFromAxisAngle','addContactMaterial','getItem','catch','collide','fail','Erro\x203D:','<img\x20src=\x22goliathf.png\x22\x20class=\x22avatar-img\x22\x20alt=\x22Goliath\x20F\x22>','canvasContainer','<img\x20src=\x22elfwoodf.png\x22\x20class=\x22avatar-img\x22\x20alt=\x22Elfo\x20da\x20Floresta\x20F\x22>','NFD','trim','name','setupModal','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22rule-tag\x20','.avatar-option','Média:\x20','charColorInput','<img\x20src=\x22elfdrowf.png\x22\x20class=\x22avatar-img\x22\x20alt=\x22Drow\x20F\x22>','<img\x20src=\x22humanm.png\x22\x20class=\x22avatar-img\x22\x20alt=\x22Humano\x22>','ondragover','mouseup','.cat-btn','sort','./start.mp3','meta','class','campaignNameInput','campaign','<img\x20src=\x22gnomem.png\x22\x20class=\x22avatar-img\x22\x20alt=\x22Gnomo\x22>','join','characters','toFixed','crit','Condição','querySelector','right','.dice-btn','includes','map','ondragstart','991074ZgmhxD','bottom','<img\x20src=\x22master.png\x22\x20class=\x22avatar-img\x22\x20alt=\x22Mestre\x22>','historyList','text','\x20log-crit-success','fov','Scene','mousedown','push','Erro\x20som:\x20','iterations','feat','Truque','set','<div\x20class=\x22log-meta\x22><span\x20class=\x22log-char-name\x22\x20style=\x22color:\x20','</div>','BoxGeometry','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22roll-formula\x22>','length','rgba(','abs','particles','Erro\x20ao\x20adicionar\x20personagem.\x20Tente\x20\x27Reiniciar\x20Jornada\x27\x20nas\x20configurações.',';\x20font-weight:bold;\x22>','destination','\x22>0</span>'];a0_0x183b=function(){return _0x4f843e;};return a0_0x183b();}